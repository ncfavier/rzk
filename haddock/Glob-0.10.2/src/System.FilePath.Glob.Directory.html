<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- File created: 2008-10-16 12:12:50</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.FilePath.Glob.Directory</span><span>
</span><span id="line-4"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier">GlobOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDefault"><span class="hs-identifier">globDefault</span></a></span><span>
</span><span id="line-5"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir"><span class="hs-identifier">globDir</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDirWith"><span class="hs-identifier">globDirWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir1"><span class="hs-identifier">globDir1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#glob"><span class="hs-identifier">glob</span></a></span><span>
</span><span id="line-6"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#commonDirectory"><span class="hs-identifier">commonDirectory</span></a></span><span>
</span><span id="line-7"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DList</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">doesDirectoryExist</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getDirectoryContents</span></span><span>
</span><span id="line-15"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCurrentDirectory</span></span><span>
</span><span id="line-16"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">takeDrive</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">splitDrive</span></span><span>
</span><span id="line-18"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isExtSeparator</span></span><span>
</span><span id="line-19"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pathSeparator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPathSeparator</span></span><span>
</span><span id="line-20"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">takeDirectory</span></span><span>
</span><span id="line-21"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html"><span class="hs-identifier">System.FilePath.Glob.Base</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier">Pattern</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier">MatchOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#matchDefault"><span class="hs-identifier">matchDefault</span></a></span><span>
</span><span id="line-25"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier">compile</span></a></span><span>
</span><span id="line-26"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Match.html"><span class="hs-identifier">System.FilePath.Glob.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Match.html#matchWith"><span class="hs-identifier">matchWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html"><span class="hs-identifier">System.FilePath.Glob.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#getRecursiveContents"><span class="hs-identifier">getRecursiveContents</span></a></span><span>
</span><span id="line-29"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#nubOrd"><span class="hs-identifier">nubOrd</span></a></span><span>
</span><span id="line-30"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#pathParts"><span class="hs-identifier">pathParts</span></a></span><span>
</span><span id="line-31"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#partitionDL"><span class="hs-identifier">partitionDL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#tailDL"><span class="hs-identifier">tailDL</span></a></span><span>
</span><span id="line-32"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#catchIO"><span class="hs-identifier">catchIO</span></a></span><span>
</span><span id="line-33"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="annot"><span class="hs-comment">-- |Options which can be passed to the 'globDirWith' function.</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="GlobOptions"><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-var">GlobOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GlobOptions"><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-var">GlobOptions</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="matchOptions"><span class="annot"><span class="annottext">GlobOptions -&gt; MatchOptions
</span><a href="System.FilePath.Glob.Directory.html#matchOptions"><span class="hs-identifier hs-var hs-var">matchOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-type">MatchOptions</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^Options controlling how matching is performed; see 'MatchOptions'.</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="includeUnmatched"><span class="annot"><span class="annottext">GlobOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Directory.html#includeUnmatched"><span class="hs-identifier hs-var hs-var">includeUnmatched</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^Whether to include unmatched files in the result.</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- |The default set of globbing options: uses the default matching options, and</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- does not include unmatched files.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDefault"><span class="hs-identifier hs-type">globDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span>
</span><span id="line-45"></span><span id="globDefault"><span class="annot"><span class="annottext">globDefault :: GlobOptions
</span><a href="System.FilePath.Glob.Directory.html#globDefault"><span class="hs-identifier hs-var hs-var">globDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchOptions -&gt; Bool -&gt; GlobOptions
</span><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-var">GlobOptions</span></a></span><span> </span><span class="annot"><span class="annottext">MatchOptions
</span><a href="System.FilePath.Glob.Base.html#matchDefault"><span class="hs-identifier hs-var">matchDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- The Patterns in TypedPattern don't contain PathSeparator or AnyDirectory</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- We store the number of PathSeparators that Dir and AnyDir were followed by</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- so that &quot;foo////*&quot; can match &quot;foo/bar&quot; but return &quot;foo////bar&quot;. It's the</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- exact number for convenience: (&lt;/&gt;) doesn't add a path separator if one is</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- already there. This way, '\(Dir n _) -&gt; replicate n pathSeparator &lt;/&gt; &quot;bar&quot;'</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- results in the correct amount of slashes.</span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="TypedPattern"><span class="annot"><a href="System.FilePath.Glob.Directory.html#TypedPattern"><span class="hs-identifier hs-var">TypedPattern</span></a></span></span><span>
</span><span id="line-55"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="Any"><span class="annot"><a href="System.FilePath.Glob.Directory.html#Any"><span class="hs-identifier hs-var">Any</span></a></span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>        </span><span class="hs-comment">-- pattern</span><span>
</span><span id="line-56"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="Dir"><span class="annot"><a href="System.FilePath.Glob.Directory.html#Dir"><span class="hs-identifier hs-var">Dir</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>    </span><span class="hs-comment">-- pattern/</span><span>
</span><span id="line-57"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="AnyDir"><span class="annot"><a href="System.FilePath.Glob.Directory.html#AnyDir"><span class="hs-identifier hs-var">AnyDir</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-comment">-- pattern**/</span><span>
</span><span id="line-58"></span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679059775"><span id="local-6989586621679059788"><span id="local-6989586621679059792"><span class="annot"><span class="annottext">Int -&gt; TypedPattern -&gt; ShowS
[TypedPattern] -&gt; ShowS
TypedPattern -&gt; FilePath
(Int -&gt; TypedPattern -&gt; ShowS)
-&gt; (TypedPattern -&gt; FilePath)
-&gt; ([TypedPattern] -&gt; ShowS)
-&gt; Show TypedPattern
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TypedPattern -&gt; ShowS
showsPrec :: Int -&gt; TypedPattern -&gt; ShowS
$cshow :: TypedPattern -&gt; FilePath
show :: TypedPattern -&gt; FilePath
$cshowList :: [TypedPattern] -&gt; ShowS
showList :: [TypedPattern] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- |Matches each given 'Pattern' against the contents of the given 'FilePath',</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- recursively. The result contains the matched paths, grouped for each given</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- 'Pattern'. The results are not in any defined order.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- The given directory is prepended to all the matches: the returned paths are</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- all valid from the point of view of the current working directory.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- If multiple 'Pattern's match a single 'FilePath', that path will be included</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- in multiple groups.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Two 'FilePath's which can be canonicalized to the same file (e.g. @\&quot;foo\&quot;@</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- and @\&quot;./foo\&quot;@) may appear separately if explicit matching on paths</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- beginning with @\&quot;.\&quot;@ is done. Looking for @\&quot;.*/*\&quot;@, for instance, will</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- cause @\&quot;./foo\&quot;@ to return as a match but @\&quot;foo\&quot;@ to not be matched.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- This function is different from a simple 'filter' over all the contents of</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- the directory: the matching is performed relative to the directory, so that</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- for instance the following is true:</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &gt; fmap head (globDir [compile &quot;*&quot;] dir) == getDirectoryContents dir</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- (With the exception that that glob won't match anything beginning with @.@.)</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- If the given 'FilePath' is @[]@, 'getCurrentDirectory' will be used.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- If the given 'Pattern' starts with a drive (as defined by</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- 'System.FilePath'), it is not relative to the given directory and the</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- 'FilePath' parameter is completely ignored! Similarly, if the given</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- 'Pattern' starts with a path separator, only the drive part of the</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- 'FilePath' is used. On Posix systems these behaviours are equivalent:</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- 'Pattern's starting with @\/@ work relative to @\/@. On Windows, 'Pattern's</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- starting with @\/@ or @\\@ work relative only to the drive part of the</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- 'FilePath' and 'Pattern's starting with absolute paths ignore the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- 'FilePath'.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Note that in some cases results outside the given directory may be returned:</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- for instance the @.*@ pattern matches the @..@ directory.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- Any results deeper than in the given directory are enumerated lazily, using</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- 'unsafeInterleaveIO'.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Directories without read permissions are returned as entries but their</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- contents, of course, are not.</span><span>
</span><span id="line-103"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir"><span class="hs-identifier hs-type">globDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span id="globDir"><span class="annot"><span class="annottext">globDir :: [Pattern] -&gt; FilePath -&gt; IO [[FilePath]]
</span><a href="System.FilePath.Glob.Directory.html#globDir"><span class="hs-identifier hs-var hs-var">globDir</span></a></span></span><span> </span><span id="local-6989586621679059796"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679059796"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679059797"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059797"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([[FilePath]], Maybe [FilePath]) -&gt; [[FilePath]])
-&gt; IO ([[FilePath]], Maybe [FilePath]) -&gt; IO [[FilePath]]
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([[FilePath]], Maybe [FilePath]) -&gt; [[FilePath]]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions
-&gt; [Pattern] -&gt; FilePath -&gt; IO ([[FilePath]], Maybe [FilePath])
</span><a href="System.FilePath.Glob.Directory.html#globDirWith"><span class="hs-identifier hs-var">globDirWith</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="System.FilePath.Glob.Directory.html#globDefault"><span class="hs-identifier hs-var">globDefault</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679059796"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059797"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- |Like 'globDir', but applies the given 'GlobOptions' instead of the</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- defaults when matching. The first component of the returned tuple contains</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- the matched paths, grouped for each given 'Pattern', and the second contains</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Just the unmatched paths if the given 'GlobOptions' specified that unmatched</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- files should be included, or otherwise Nothing.</span><span>
</span><span id="line-111"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDirWith"><span class="hs-identifier hs-type">globDirWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span id="globDirWith"><span class="annot"><span class="annottext">globDirWith :: GlobOptions
-&gt; [Pattern] -&gt; FilePath -&gt; IO ([[FilePath]], Maybe [FilePath])
</span><a href="System.FilePath.Glob.Directory.html#globDirWith"><span class="hs-identifier hs-var hs-var">globDirWith</span></a></span></span><span> </span><span id="local-6989586621679059799"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059799"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679059800"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059800"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679059801"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059801"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Directory.html#includeUnmatched"><span class="hs-identifier hs-var">includeUnmatched</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059799"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>   </span><span class="hs-comment">-- This is an optimization for the case where only one pattern has been</span><span>
</span><span id="line-115"></span><span>   </span><span class="hs-comment">-- passed and we are not including unmatched files: we can use</span><span>
</span><span id="line-116"></span><span>   </span><span class="hs-comment">-- 'commonDirectory' to avoid some calls to 'getDirectoryContents'.</span><span>
</span><span id="line-117"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059803"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059803"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059804"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059804"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; (FilePath, Pattern)
</span><a href="System.FilePath.Glob.Directory.html#commonDirectory"><span class="hs-identifier hs-var">commonDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059800"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; [Pattern] -&gt; FilePath -&gt; IO ([[FilePath]], Maybe [FilePath])
</span><a href="System.FilePath.Glob.Directory.html#globDirWith%27"><span class="hs-identifier hs-var">globDirWith'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059799"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059804"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059801"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059803"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDirWith"><span class="hs-identifier hs-var">globDirWith</span></a></span><span> </span><span id="local-6989586621679059806"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059806"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679059807"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679059807"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679059808"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059808"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>   </span><span class="annot"><span class="annottext">GlobOptions
-&gt; [Pattern] -&gt; FilePath -&gt; IO ([[FilePath]], Maybe [FilePath])
</span><a href="System.FilePath.Glob.Directory.html#globDirWith%27"><span class="hs-identifier hs-var">globDirWith'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059806"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679059807"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059808"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- See 'globDirWith'.</span><span>
</span><span id="line-124"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDirWith%27"><span class="hs-identifier hs-type">globDirWith'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span id="globDirWith%27"><span class="annot"><span class="annottext">globDirWith' :: GlobOptions
-&gt; [Pattern] -&gt; FilePath -&gt; IO ([[FilePath]], Maybe [FilePath])
</span><a href="System.FilePath.Glob.Directory.html#globDirWith%27"><span class="hs-identifier hs-var hs-var">globDirWith'</span></a></span></span><span> </span><span id="local-6989586621679059809"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059809"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span id="local-6989586621679059810"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059810"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GlobOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Directory.html#includeUnmatched"><span class="hs-identifier hs-var">includeUnmatched</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059809"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>         </span><span id="local-6989586621679059811"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059811"><span class="hs-identifier hs-var">dir'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059810"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059810"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-130"></span><span>         </span><span id="local-6989586621679059813"><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059813"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (DList FilePath)
</span><a href="System.FilePath.Glob.Utils.html#getRecursiveContents"><span class="hs-identifier hs-var">getRecursiveContents</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059811"><span class="hs-identifier hs-var">dir'</span></a></span><span>
</span><span id="line-131"></span><span>         </span><span class="annot"><span class="annottext">([[FilePath]], Maybe [FilePath])
-&gt; IO ([[FilePath]], Maybe [FilePath])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; Maybe [FilePath]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList FilePath -&gt; [FilePath]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059813"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-133"></span><span>         </span><span class="annot"><span class="annottext">([[FilePath]], Maybe [FilePath])
-&gt; IO ([[FilePath]], Maybe [FilePath])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [FilePath]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDirWith%27"><span class="hs-identifier hs-var">globDirWith'</span></a></span><span> </span><span id="local-6989586621679059815"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059815"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679059816"><span class="annot"><span class="annottext">pats :: [Pattern]
</span><a href="#local-6989586621679059816"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Pattern]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059817"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059817"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>   </span><span id="local-6989586621679059818"><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
</span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; IO (DList FilePath, DList FilePath))
-&gt; [Pattern] -&gt; IO [(DList FilePath, DList FilePath)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059820"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059820"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; Pattern -&gt; FilePath -&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#globDir%270"><span class="hs-identifier hs-var">globDir'0</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059815"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059820"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059817"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679059816"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059822"><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059822"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059823"><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059823"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
-&gt; ([DList FilePath], [DList FilePath])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
</span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-139"></span><span>       </span><span id="local-6989586621679059825"><span class="annot"><span class="annottext">allMatches :: [FilePath]
</span><a href="#local-6989586621679059825"><span class="hs-identifier hs-var hs-var">allMatches</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; [FilePath]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">(DList FilePath -&gt; [FilePath])
-&gt; ([DList FilePath] -&gt; DList FilePath)
-&gt; [DList FilePath]
-&gt; [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath] -&gt; DList FilePath
forall a. [DList a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.concat</span></span><span> </span><span class="annot"><span class="annottext">([DList FilePath] -&gt; [FilePath]) -&gt; [DList FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059822"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-140"></span><span>       </span><span id="local-6989586621679059828"><span class="annot"><span class="annottext">allOthers :: [FilePath]
</span><a href="#local-6989586621679059828"><span class="hs-identifier hs-var hs-var">allOthers</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; [FilePath]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">(DList FilePath -&gt; [FilePath])
-&gt; ([DList FilePath] -&gt; DList FilePath)
-&gt; [DList FilePath]
-&gt; [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath] -&gt; DList FilePath
forall a. [DList a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.concat</span></span><span> </span><span class="annot"><span class="annottext">([DList FilePath] -&gt; [FilePath]) -&gt; [DList FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059823"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>   </span><span class="annot"><span class="annottext">([[FilePath]], Maybe [FilePath])
-&gt; IO ([[FilePath]], Maybe [FilePath])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(DList FilePath -&gt; [FilePath]) -&gt; [DList FilePath] -&gt; [[FilePath]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; [FilePath]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059822"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GlobOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Directory.html#includeUnmatched"><span class="hs-identifier hs-var">includeUnmatched</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059815"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-144"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; Maybe [FilePath]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="System.FilePath.Glob.Utils.html#nubOrd"><span class="hs-identifier hs-var">nubOrd</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679059828"><span class="hs-identifier hs-var">allOthers</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679059825"><span class="hs-identifier hs-var">allMatches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe [FilePath]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-146"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- |A convenience wrapper on top of 'globDir', for when you only have one</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- 'Pattern' you care about. Returns only the matched paths.</span><span>
</span><span id="line-150"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir1"><span class="hs-identifier hs-type">globDir1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span id="globDir1"><span class="annot"><span class="annottext">globDir1 :: Pattern -&gt; FilePath -&gt; IO [FilePath]
</span><a href="System.FilePath.Glob.Directory.html#globDir1"><span class="hs-identifier hs-var hs-var">globDir1</span></a></span></span><span> </span><span id="local-6989586621679059829"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059829"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[FilePath]] -&gt; [FilePath]) -&gt; IO [[FilePath]] -&gt; IO [FilePath]
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[[FilePath]] -&gt; [FilePath]
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">(IO [[FilePath]] -&gt; IO [FilePath])
-&gt; (FilePath -&gt; IO [[FilePath]]) -&gt; FilePath -&gt; IO [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; FilePath -&gt; IO [[FilePath]]
</span><a href="System.FilePath.Glob.Directory.html#globDir"><span class="hs-identifier hs-var">globDir</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059829"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- |The simplest IO function. Finds matches to the given pattern in the current</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- working directory. Takes a 'String' instead of a 'Pattern' to avoid the need</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- for a call to 'compile', simplifying usage further.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Can also be seen as a convenience wrapper on top of 'globDir1', for when you</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- want to work in the current directory or have a pattern referring to an</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- absolute path.</span><span>
</span><span id="line-160"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#glob"><span class="hs-identifier hs-type">glob</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span id="glob"><span class="annot"><span class="annottext">glob :: FilePath -&gt; IO [FilePath]
</span><a href="System.FilePath.Glob.Directory.html#glob"><span class="hs-identifier hs-var hs-var">glob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; FilePath -&gt; IO [FilePath])
-&gt; FilePath -&gt; Pattern -&gt; IO [FilePath]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; FilePath -&gt; IO [FilePath]
</span><a href="System.FilePath.Glob.Directory.html#globDir1"><span class="hs-identifier hs-var">globDir1</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; IO [FilePath])
-&gt; (FilePath -&gt; Pattern) -&gt; FilePath -&gt; IO [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir%270"><span class="hs-identifier hs-type">globDir'0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="globDir%270"><span class="annot"><span class="annottext">globDir'0 :: GlobOptions
-&gt; Pattern -&gt; FilePath -&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#globDir%270"><span class="hs-identifier hs-var hs-var">globDir'0</span></a></span></span><span> </span><span id="local-6989586621679059832"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059832"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679059833"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059833"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679059834"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059834"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059835"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059835"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059836"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679059836"><span class="hs-identifier hs-var">drive</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; (Pattern, Maybe FilePath)
</span><a href="System.FilePath.Glob.Directory.html#driveSplit"><span class="hs-identifier hs-var">driveSplit</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059833"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-167"></span><span>   </span><span id="local-6989586621679059838"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">dir'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679059836"><span class="hs-identifier hs-var">drive</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; IO FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeDrive</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span>
</span><span id="line-169"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059839"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059839"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059839"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-170"></span><span>                </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059834"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">getCurrentDirectory</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059834"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-171"></span><span>   </span><span class="annot"><span class="annottext">GlobOptions
-&gt; [TypedPattern]
-&gt; FilePath
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#globDir%27"><span class="hs-identifier hs-var">globDir'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059832"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [TypedPattern]
</span><a href="System.FilePath.Glob.Directory.html#separate"><span class="hs-identifier hs-var">separate</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059835"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">dir'</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir%27"><span class="hs-identifier hs-type">globDir'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#TypedPattern"><span class="hs-identifier hs-type">TypedPattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-174"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="globDir%27"><span class="annot"><span class="annottext">globDir' :: GlobOptions
-&gt; [TypedPattern]
-&gt; FilePath
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#globDir%27"><span class="hs-identifier hs-var hs-var">globDir'</span></a></span></span><span> </span><span id="local-6989586621679059842"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059842"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679059843"><span class="annot"><span class="annottext">pats :: [TypedPattern]
</span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedPattern
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[TypedPattern]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059844"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>   </span><span id="local-6989586621679059845"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FilePath]
</span><span class="hs-identifier hs-var">getDirectoryContents</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; (IOException -&gt; IO [FilePath]) -&gt; IO [FilePath]
forall a. IO a -&gt; (IOException -&gt; IO a) -&gt; IO a
</span><a href="System.FilePath.Glob.Utils.html#catchIO"><span class="hs-operator hs-var">`catchIO`</span></a></span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; IOException -&gt; IO [FilePath]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; IO [FilePath]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>   </span><span id="local-6989586621679059847"><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FilePath]
-&gt; (FilePath -&gt; IO (DList FilePath, DList FilePath))
-&gt; IO [(DList FilePath, DList FilePath)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO (DList FilePath, DList FilePath))
 -&gt; IO [(DList FilePath, DList FilePath)])
-&gt; (FilePath -&gt; IO (DList FilePath, DList FilePath))
-&gt; IO [(DList FilePath, DList FilePath)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059848"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; [TypedPattern]
-&gt; FilePath
-&gt; FilePath
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-var">matchTypedAndGo</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059842"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059850"><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059850"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059851"><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
-&gt; ([DList FilePath], [DList FilePath])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(DList FilePath, DList FilePath)]
</span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>   </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DList FilePath] -&gt; DList FilePath
forall a. [DList a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.concat</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059850"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DList FilePath] -&gt; DList FilePath
forall a. [DList a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.concat</span></span><span> </span><span class="annot"><span class="annottext">[DList FilePath]
</span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">others</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#globDir%27"><span class="hs-identifier hs-var">globDir'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679059852"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>   </span><span class="hs-comment">-- We can only get here from matchTypedAndGo getting a [Dir _]: it means the</span><span>
</span><span id="line-186"></span><span>   </span><span class="hs-comment">-- original pattern had a trailing PathSeparator. Reproduce it here.</span><span>
</span><span id="line-187"></span><span>   </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; DList FilePath
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-type">matchTypedAndGo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span>
</span><span id="line-190"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#TypedPattern"><span class="hs-identifier hs-type">TypedPattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-192"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- (Any p) is always the last element</span><span>
</span><span id="line-195"></span><span id="matchTypedAndGo"><span class="annot"><span class="annottext">matchTypedAndGo :: GlobOptions
-&gt; [TypedPattern]
-&gt; FilePath
-&gt; FilePath
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-var hs-var">matchTypedAndGo</span></a></span></span><span> </span><span id="local-6989586621679059855"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621679059856"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679059857"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059858"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">absPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MatchOptions -&gt; Pattern -&gt; FilePath -&gt; Bool
</span><a href="System.FilePath.Glob.Match.html#matchWith"><span class="hs-identifier hs-var">matchWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions -&gt; MatchOptions
</span><a href="System.FilePath.Glob.Directory.html#matchOptions"><span class="hs-identifier hs-var">matchOptions</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; DList FilePath
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">absPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool
-&gt; (Bool -&gt; IO (DList FilePath, DList FilePath))
-&gt; IO (DList FilePath, DList FilePath)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; FilePath
-&gt; FilePath
-&gt; Bool
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-var">didNotMatch</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-var">matchTypedAndGo</span></a></span><span> </span><span id="local-6989586621679059860"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span id="local-6989586621679059861"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059862"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059863"><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059864"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059865"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">absPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>   </span><span id="local-6989586621679059866"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">isDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-202"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">isDir</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">MatchOptions -&gt; Pattern -&gt; FilePath -&gt; Bool
</span><a href="System.FilePath.Glob.Match.html#matchWith"><span class="hs-identifier hs-var">matchWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions -&gt; MatchOptions
</span><a href="System.FilePath.Glob.Directory.html#matchOptions"><span class="hs-identifier hs-var">matchOptions</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; [TypedPattern]
-&gt; FilePath
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#globDir%27"><span class="hs-identifier hs-var">globDir'</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; FilePath
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; FilePath
-&gt; FilePath
-&gt; Bool
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-var">didNotMatch</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">isDir</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-var">matchTypedAndGo</span></a></span><span> </span><span id="local-6989586621679059869"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#AnyDir"><span class="hs-identifier hs-type">AnyDir</span></a></span><span> </span><span id="local-6989586621679059870"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059871"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059871"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059872"><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059873"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059874"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GlobOptions
-&gt; FilePath
-&gt; FilePath
-&gt; Bool
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-var">didNotMatch</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>         </span><span id="local-6989586621679059876"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">isDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-211"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059877"><span class="annot"><span class="annottext">m :: FilePath -&gt; Bool
</span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchOptions -&gt; Pattern -&gt; FilePath -&gt; Bool
</span><a href="System.FilePath.Glob.Match.html#matchWith"><span class="hs-identifier hs-var">matchWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions -&gt; MatchOptions
</span><a href="System.FilePath.Glob.Directory.html#matchOptions"><span class="hs-identifier hs-var">matchOptions</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypedPattern] -&gt; Pattern
</span><a href="System.FilePath.Glob.Directory.html#unseparate"><span class="hs-identifier hs-var">unseparate</span></a></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>             </span><span id="local-6989586621679059882"><span class="annot"><span class="annottext">unconditionalMatch :: Bool
</span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var hs-var">unconditionalMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>                </span><span class="annot"><span class="annottext">[Token] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059871"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isExtSeparator</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Char -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>             </span><span id="local-6989586621679059884"><span class="annot"><span class="annottext">p' :: Pattern
</span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059871"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyNonPathSeparator"><span class="hs-identifier hs-var">AnyNonPathSeparator</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var">unconditionalMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">MatchOptions -&gt; Pattern -&gt; FilePath -&gt; Bool
</span><a href="System.FilePath.Glob.Match.html#matchWith"><span class="hs-identifier hs-var">matchWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobOptions -&gt; MatchOptions
</span><a href="System.FilePath.Glob.Directory.html#matchOptions"><span class="hs-identifier hs-var">matchOptions</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>              </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">isDir</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>                 </span><span id="local-6989586621679059887"><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (DList FilePath)
</span><a href="System.FilePath.Glob.Utils.html#getRecursiveContents"><span class="hs-identifier hs-var">getRecursiveContents</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-219"></span><span>                 </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((DList FilePath, DList FilePath)
 -&gt; IO (DList FilePath, DList FilePath))
-&gt; (DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-220"></span><span>                    </span><span class="hs-comment">-- foo**/ should match foo/ and nothing below it</span><span>
</span><span id="line-221"></span><span>                    </span><span class="hs-comment">-- relies on head contents == absPath</span><span>
</span><span id="line-222"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[TypedPattern] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-223"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; DList FilePath
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; DList FilePath) -&gt; FilePath -&gt; DList FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>                                </span><span class="annot"><span class="annottext">DList FilePath -&gt; FilePath
forall a. DList a -&gt; a
</span><span class="hs-identifier hs-var">DL.head</span></span><span> </span><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-225"></span><span>                                </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; FilePath
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span>
</span><span id="line-226"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; DList FilePath
forall a. DList a -&gt; DList a
</span><a href="System.FilePath.Glob.Utils.html#tailDL"><span class="hs-identifier hs-var">tailDL</span></a></span><span> </span><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-227"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059890"><span class="annot"><span class="annottext">DList (Bool, FilePath)
</span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059891"><span class="annot"><span class="annottext">DList (Bool, FilePath)
</span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">nonMatches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>                                   </span><span class="annot"><span class="annottext">((Bool, FilePath) -&gt; Bool)
-&gt; DList (Bool, FilePath)
-&gt; (DList (Bool, FilePath), DList (Bool, FilePath))
forall a. (a -&gt; Bool) -&gt; DList a -&gt; (DList a, DList a)
</span><a href="System.FilePath.Glob.Utils.html#partitionDL"><span class="hs-identifier hs-var">partitionDL</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, FilePath) -&gt; Bool
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-230"></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; (Bool, FilePath))
-&gt; DList FilePath -&gt; DList (Bool, FilePath)
forall a b. (a -&gt; b) -&gt; DList a -&gt; DList b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (FilePath -&gt; Bool) -&gt; FilePath -&gt; (Bool, FilePath)
</span><a href="System.FilePath.Glob.Directory.html#recursiveMatch"><span class="hs-identifier hs-var">recursiveMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DList FilePath
</span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">contents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Bool, FilePath) -&gt; FilePath)
-&gt; DList (Bool, FilePath) -&gt; DList FilePath
forall a b. (a -&gt; b) -&gt; DList a -&gt; DList b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Bool, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">DList (Bool, FilePath)
</span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((Bool, FilePath) -&gt; FilePath)
-&gt; DList (Bool, FilePath) -&gt; DList FilePath
forall a b. (a -&gt; b) -&gt; DList a -&gt; DList b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Bool, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">DList (Bool, FilePath)
</span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">nonMatches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>              </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>                 </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; DList FilePath
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; DList FilePath) -&gt; FilePath -&gt; DList FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-235"></span><span>                             </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-236"></span><span>                             </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; FilePath
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span>
</span><span id="line-237"></span><span>                             </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-238"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span>
</span><span id="line-239"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>              </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>                 </span><span class="annot"><span class="annottext">GlobOptions
-&gt; FilePath
-&gt; FilePath
-&gt; Bool
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-var">didNotMatch</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">isDir</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#matchTypedAndGo"><span class="hs-identifier hs-var">matchTypedAndGo</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (DList FilePath, DList FilePath)
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Glob.matchTypedAndGo :: internal error&quot;</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- To be called to check whether a filepath matches the part of a pattern</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- following an **/ (AnyDirectory) token and reconstruct the filepath with the</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- correct number of slashes. Arguments are:</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-comment">-- * Int: number of slashes in the AnyDirectory token, i.e. 1 for **/, 2 for</span></span><span>
</span><span id="line-250"></span><span class="hs-comment">--   **//, and so on</span><span>
</span><span id="line-251"></span><span class="hs-comment">--</span><span>
</span><span id="line-252"></span><span class="annot"><span class="hs-comment">-- * FilePath -&gt; Bool: matching function for the remainder of the pattern, to</span></span><span>
</span><span id="line-253"></span><span class="hs-comment">--   determine whether the rest of the filepath following the AnyDirectory token</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   matches</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="annot"><span class="hs-comment">-- * FilePath: the (entire) filepath to be checked: some file which is in a</span></span><span>
</span><span id="line-257"></span><span class="hs-comment">--   subdirectory of a directory which matches the prefix of the pattern up to</span><span>
</span><span id="line-258"></span><span class="hs-comment">--   the AnyDirectory token.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- The returned tuple contains both the result, where True means the filepath</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- matches and should be included in the resulting list of matching files, and</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- False otherwise. We also include the filepath in the returned tuple, because</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- this function also takes care of including the correct number of slashes</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- in the result. For example, with a pattern **//foo/bar.txt, this function</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- would ensure that, if dir/foo/bar.txt exists, it would be returned as</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- dir//foo/bar.txt.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#recursiveMatch"><span class="hs-identifier hs-type">recursiveMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span id="recursiveMatch"><span class="annot"><span class="annottext">recursiveMatch :: Int -&gt; (FilePath -&gt; Bool) -&gt; FilePath -&gt; (Bool, FilePath)
</span><a href="System.FilePath.Glob.Directory.html#recursiveMatch"><span class="hs-identifier hs-var hs-var">recursiveMatch</span></a></span></span><span> </span><span id="local-6989586621679059895"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059896"><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">isMatch</span></a></span></span><span> </span><span id="local-6989586621679059897"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; [FilePath] -&gt; Maybe FilePath
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">isMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="System.FilePath.Glob.Utils.html#pathParts"><span class="hs-identifier hs-var">pathParts</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059898"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">matchedSuffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059902"><span class="annot"><span class="annottext">dir :: FilePath
</span><a href="#local-6989586621679059902"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">matchedSuffix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-273"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059902"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-274"></span><span>                 </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; FilePath
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span>
</span><span id="line-275"></span><span>                 </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">matchedSuffix</span></a></span><span>
</span><span id="line-276"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- To be called when a pattern didn't match a path: given the path and whether</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- it was a directory, return all paths which didn't match (i.e. for a file,</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- just the file, and for a directory, everything inside it).</span><span>
</span><span id="line-283"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-type">didNotMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#GlobOptions"><span class="hs-identifier hs-type">GlobOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-284"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span id="didNotMatch"><span class="annot"><span class="annottext">didNotMatch :: GlobOptions
-&gt; FilePath
-&gt; FilePath
-&gt; Bool
-&gt; IO (DList FilePath, DList FilePath)
</span><a href="System.FilePath.Glob.Directory.html#didNotMatch"><span class="hs-identifier hs-var hs-var">didNotMatch</span></a></span></span><span> </span><span id="local-6989586621679059905"><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059905"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679059906"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059907"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">absPath</span></a></span></span><span> </span><span id="local-6989586621679059908"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var">isDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GlobOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Directory.html#includeUnmatched"><span class="hs-identifier hs-var">includeUnmatched</span></a></span><span> </span><span class="annot"><span class="annottext">GlobOptions
</span><a href="#local-6989586621679059905"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(DList FilePath -&gt; (DList FilePath, DList FilePath))
-&gt; IO (DList FilePath) -&gt; IO (DList FilePath, DList FilePath)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (DList FilePath) -&gt; IO (DList FilePath, DList FilePath))
-&gt; IO (DList FilePath) -&gt; IO (DList FilePath, DList FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-288"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var">isDir</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-290"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; IO (DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span>
</span><span id="line-291"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (DList FilePath)
</span><a href="System.FilePath.Glob.Utils.html#getRecursiveContents"><span class="hs-identifier hs-var">getRecursiveContents</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">DList FilePath -&gt; IO (DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="annot"><span class="annottext">(DList FilePath -&gt; IO (DList FilePath))
-&gt; DList FilePath -&gt; IO (DList FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; DList FilePath
forall a. a -&gt; DList a
</span><span class="hs-identifier hs-var">DL.singleton</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-294"></span><span>         </span><span class="annot"><span class="annottext">(DList FilePath, DList FilePath)
-&gt; IO (DList FilePath, DList FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DList FilePath
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#separate"><span class="hs-identifier hs-type">separate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#TypedPattern"><span class="hs-identifier hs-type">TypedPattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span id="separate"><span class="annot"><span class="annottext">separate :: Pattern -&gt; [TypedPattern]
</span><a href="System.FilePath.Glob.Directory.html#separate"><span class="hs-identifier hs-var hs-var">separate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Token -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [TypedPattern])
-&gt; (Pattern -&gt; [Token]) -&gt; Pattern -&gt; [TypedPattern]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-298"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>   </span><span id="local-6989586621679059909"><span class="annot"><span class="annottext">go :: DList Token -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679059913"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Token -&gt; [Token]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>   </span><span class="annot"><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679059914"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; TypedPattern
</span><a href="System.FilePath.Glob.Directory.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Token -&gt; Pattern
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>   </span><span class="annot"><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679059916"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059918"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Token
-&gt; (Int -&gt; Pattern -&gt; TypedPattern) -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">slash</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pattern -&gt; TypedPattern
</span><a href="System.FilePath.Glob.Directory.html#Dir"><span class="hs-identifier hs-var">Dir</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-302"></span><span>   </span><span class="annot"><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679059920"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059922"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Token
-&gt; (Int -&gt; Pattern -&gt; TypedPattern) -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">slash</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pattern -&gt; TypedPattern
</span><a href="System.FilePath.Glob.Directory.html#AnyDir"><span class="hs-identifier hs-var">AnyDir</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-303"></span><span>   </span><span class="annot"><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679059923"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span class="hs-special">(</span><span>            </span><span id="local-6989586621679059924"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059924"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059925"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059925"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Token -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token -&gt; Token -&gt; DList Token
forall a. DList a -&gt; a -&gt; DList a
</span><span class="hs-operator hs-var">`DL.snoc`</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059924"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059925"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>   </span><span id="local-6989586621679059915"><span class="annot"><span class="annottext">pat :: DList Token -&gt; Pattern
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern)
-&gt; (DList Token -&gt; [Token]) -&gt; DList Token -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DList Token -&gt; [Token]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>   </span><span id="local-6989586621679059919"><span class="annot"><span class="annottext">slash :: DList Token
-&gt; (Int -&gt; Pattern -&gt; TypedPattern) -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var hs-var">slash</span></a></span></span><span> </span><span id="local-6989586621679059927"><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059927"><span class="hs-identifier hs-var">gr</span></a></span></span><span> </span><span id="local-6989586621679059928"><span class="annot"><span class="annottext">Int -&gt; Pattern -&gt; TypedPattern
</span><a href="#local-6989586621679059928"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059929"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059929"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059932"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059933"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059933"><span class="hs-identifier hs-var">ps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Int) -&gt; ([Token], [Token]) -&gt; (Int, [Token])
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(([Token], [Token]) -&gt; (Int, [Token]))
-&gt; ([Token] -&gt; ([Token], [Token])) -&gt; [Token] -&gt; (Int, [Token])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Bool) -&gt; [Token] -&gt; ([Token], [Token])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var">isSlash</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; (Int, [Token])) -&gt; [Token] -&gt; (Int, [Token])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059929"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-308"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Pattern -&gt; TypedPattern
</span><a href="#local-6989586621679059928"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059932"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Token -&gt; Pattern
</span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
</span><a href="#local-6989586621679059927"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypedPattern -&gt; [TypedPattern] -&gt; [TypedPattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">DList Token -&gt; [Token] -&gt; [TypedPattern]
</span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">DList Token
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059933"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>   </span><span id="local-6989586621679059935"><span class="annot"><span class="annottext">isSlash :: Token -&gt; Bool
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var hs-var">isSlash</span></a></span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-311"></span><span>   </span><span class="annot"><a href="#local-6989586621679059935"><span class="hs-identifier hs-var">isSlash</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#unseparate"><span class="hs-identifier hs-type">unseparate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#TypedPattern"><span class="hs-identifier hs-type">TypedPattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-314"></span><span id="unseparate"><span class="annot"><span class="annottext">unseparate :: [TypedPattern] -&gt; Pattern
</span><a href="System.FilePath.Glob.Directory.html#unseparate"><span class="hs-identifier hs-var hs-var">unseparate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern)
-&gt; ([TypedPattern] -&gt; [Token]) -&gt; [TypedPattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TypedPattern -&gt; [Token] -&gt; [Token])
-&gt; [Token] -&gt; [TypedPattern] -&gt; [Token]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">TypedPattern -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>   </span><span id="local-6989586621679059938"><span class="annot"><span class="annottext">f :: TypedPattern -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#AnyDir"><span class="hs-identifier hs-type">AnyDir</span></a></span><span> </span><span id="local-6989586621679059941"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059941"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059942"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059942"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059943"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059942"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Token -&gt; [Token]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059941"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-317"></span><span>   </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span>   </span><span class="annot"><a href="System.FilePath.Glob.Directory.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span id="local-6989586621679059945"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059945"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059946"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059946"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059947"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059947"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059946"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Token -&gt; [Token]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059945"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059947"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-318"></span><span>   </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span>      </span><span id="local-6989586621679059948"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059948"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059949"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059949"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059948"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059949"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>   </span><span id="local-6989586621679059944"><span class="annot"><span class="annottext">u :: Pattern -&gt; [Token]
</span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- Note that we consider &quot;/foo&quot; to specify a drive on Windows, even though it's</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- relative to the current drive.</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Returns the [TypedPattern] of the Pattern (with the drive dropped if</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- appropriate) and, if the Pattern specified a drive, a Maybe representing the</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- drive to use. If it's a Just &quot;&quot;, use the drive of the current working</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-329"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#driveSplit"><span class="hs-identifier hs-type">driveSplit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span id="driveSplit"><span class="annot"><span class="annottext">driveSplit :: Pattern -&gt; (Pattern, Maybe FilePath)
</span><a href="System.FilePath.Glob.Directory.html#driveSplit"><span class="hs-identifier hs-var hs-var">driveSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, [Token]) -&gt; (Pattern, Maybe FilePath)
</span><a href="#local-6989586621679059950"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath, [Token]) -&gt; (Pattern, Maybe FilePath))
-&gt; (Pattern -&gt; (FilePath, [Token]))
-&gt; Pattern
-&gt; (Pattern, Maybe FilePath)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; (FilePath, [Token])
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; (FilePath, [Token]))
-&gt; (Pattern -&gt; [Token]) -&gt; Pattern -&gt; (FilePath, [Token])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-331"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>   </span><span class="hs-comment">-- We can't just use something like commonDirectory because of Windows</span><span>
</span><span id="line-333"></span><span>   </span><span class="hs-comment">-- drives being possibly longer than one &quot;directory&quot;, like &quot;//?/foo/bar/&quot;.</span><span>
</span><span id="line-334"></span><span>   </span><span class="hs-comment">-- So just take as much as possible.</span><span>
</span><span id="line-335"></span><span>   </span><span id="local-6989586621679059951"><span class="annot"><span class="annottext">split :: [Token] -&gt; (FilePath, [Token])
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679059956"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059956"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059957"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059957"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (FilePath, [Token]) -&gt; (FilePath, [Token])
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059956"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; (FilePath, [Token])
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059957"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>   </span><span class="annot"><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span>    </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>   </span><span id="local-6989586621679059959"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059959"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059960"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (FilePath, [Token]) -&gt; (FilePath, [Token])
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059959"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; (FilePath, [Token])
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>   </span><span class="annot"><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span>   </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059961"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059961"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (FilePath, [Token]) -&gt; (FilePath, [Token])
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; (FilePath, [Token])
</span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059961"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>   </span><span class="annot"><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679059962"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059962"><span class="hs-identifier hs-var">xs</span></a></span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059962"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>   </span><span class="hs-comment">-- The isPathSeparator check is interesting in two ways:</span><span>
</span><span id="line-341"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span>   </span><span class="hs-comment">-- 1. It's correct to return simply Just &quot;&quot; because there can't be more than</span><span>
</span><span id="line-343"></span><span>   </span><span class="hs-comment">--    one path separator if splitDrive gave a null drive: &quot;//x&quot; is a shared</span><span>
</span><span id="line-344"></span><span>   </span><span class="hs-comment">--    &quot;drive&quot; in Windows and starts with the root &quot;drive&quot; in Posix.</span><span>
</span><span id="line-345"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-346"></span><span>   </span><span class="hs-comment">-- 2. The 'head' is safe because we have not (null d) &amp;&amp; null drive.</span><span>
</span><span id="line-347"></span><span>   </span><span id="local-6989586621679059950"><span class="annot"><span class="annottext">check :: (FilePath, [Token]) -&gt; (Pattern, Maybe FilePath)
</span><a href="#local-6989586621679059950"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059969"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059970"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">d</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span>     </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">drive</span></a></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [Token] -&gt; Pattern
forall {t :: * -&gt; *}. Foldable t =&gt; t Char -&gt; [Token] -&gt; Pattern
</span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var">dirify</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">drive</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span>     </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [Token] -&gt; Pattern
forall {t :: * -&gt; *}. Foldable t =&gt; t Char -&gt; [Token] -&gt; Pattern
</span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var">dirify</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">d</span></a></span><span>    </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679059971"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">drive</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059973"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><span class="hs-identifier hs-var">splitDrive</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>   </span><span id="local-6989586621679059972"><span class="annot"><span class="annottext">dirify :: t Char -&gt; [Token] -&gt; Pattern
</span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var hs-var">dirify</span></a></span></span><span> </span><span id="local-6989586621679059976"><span class="annot"><span class="annottext">t Char
</span><a href="#local-6989586621679059976"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern) -&gt; ([Token] -&gt; [Token]) -&gt; [Token] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t Char -&gt; [Token]
forall {t :: * -&gt; *}. Foldable t =&gt; t Char -&gt; [Token]
</span><a href="#local-6989586621679059977"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">t Char
</span><a href="#local-6989586621679059976"><span class="hs-identifier hs-var">path</span></a></span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>   </span><span id="local-6989586621679059977"><span class="annot"><span class="annottext">comp :: t Char -&gt; [Token]
</span><a href="#local-6989586621679059977"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679059980"><span class="annot"><span class="annottext">t Char
</span><a href="#local-6989586621679059980"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059982"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059983"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ([Token], FilePath) -&gt; ([Token], FilePath))
-&gt; ([Token], FilePath) -&gt; t Char -&gt; ([Token], FilePath)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ([Token], FilePath) -&gt; ([Token], FilePath)
</span><a href="#local-6989586621679059984"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Char
</span><a href="#local-6989586621679059980"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>      </span><span id="local-6989586621679059984"><span class="annot"><span class="annottext">f :: Char -&gt; ([Token], FilePath) -&gt; ([Token], FilePath)
</span><a href="#local-6989586621679059984"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059986"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059987"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059988"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isExtSeparator</span></span><span>  </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>   </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">ll</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621679059985"><span class="annot"><span class="annottext">ll :: FilePath -&gt; [Token] -&gt; [Token]
</span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var hs-var">ll</span></a></span></span><span> </span><span id="local-6989586621679059991"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679059992"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- |Factors out the directory component of a 'Pattern'. Useful in conjunction</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- with 'globDir'.</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- Preserves the number of path separators: @commonDirectory (compile</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- \&quot;foo\/\/\/bar\&quot;)@ becomes @(\&quot;foo\/\/\/\&quot;, compile \&quot;bar\&quot;)@.</span><span>
</span><span id="line-370"></span><span class="annot"><a href="System.FilePath.Glob.Directory.html#commonDirectory"><span class="hs-identifier hs-type">commonDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span id="commonDirectory"><span class="annot"><span class="annottext">commonDirectory :: Pattern -&gt; (FilePath, Pattern)
</span><a href="System.FilePath.Glob.Directory.html#commonDirectory"><span class="hs-identifier hs-var hs-var">commonDirectory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TypedPattern] -&gt; Pattern)
-&gt; (FilePath, [TypedPattern]) -&gt; (FilePath, Pattern)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">[TypedPattern] -&gt; Pattern
</span><a href="System.FilePath.Glob.Directory.html#unseparate"><span class="hs-identifier hs-var">unseparate</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath, [TypedPattern]) -&gt; (FilePath, Pattern))
-&gt; (Pattern -&gt; (FilePath, [TypedPattern]))
-&gt; Pattern
-&gt; (FilePath, Pattern)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TypedPattern] -&gt; (FilePath, [TypedPattern])
</span><a href="#local-6989586621679059993"><span class="hs-identifier hs-var">splitP</span></a></span><span> </span><span class="annot"><span class="annottext">([TypedPattern] -&gt; (FilePath, [TypedPattern]))
-&gt; (Pattern -&gt; [TypedPattern])
-&gt; Pattern
-&gt; (FilePath, [TypedPattern])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [TypedPattern]
</span><a href="System.FilePath.Glob.Directory.html#separate"><span class="hs-identifier hs-var">separate</span></a></span><span>
</span><span id="line-372"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>   </span><span id="local-6989586621679059993"><span class="annot"><span class="annottext">splitP :: [TypedPattern] -&gt; (FilePath, [TypedPattern])
</span><a href="#local-6989586621679059993"><span class="hs-identifier hs-var hs-var">splitP</span></a></span></span><span> </span><span id="local-6989586621679059995"><span class="annot"><span class="annottext">pt :: [TypedPattern]
</span><a href="#local-6989586621679059995"><span class="hs-identifier hs-var">pt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Directory.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span id="local-6989586621679059996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059996"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059997"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059997"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059998"><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059998"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DList Char -&gt; [Token] -&gt; Maybe FilePath
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span class="annot"><span class="annottext">DList Char
forall a. DList a
</span><span class="hs-identifier hs-var">DL.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679059997"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679060000"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (FilePath, [TypedPattern]) -&gt; (FilePath, [TypedPattern])
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; FilePath
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059996"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypedPattern] -&gt; (FilePath, [TypedPattern])
</span><a href="#local-6989586621679059993"><span class="hs-identifier hs-var">splitP</span></a></span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059998"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>           </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679059995"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>   </span><span class="annot"><a href="#local-6989586621679059993"><span class="hs-identifier hs-var">splitP</span></a></span><span> </span><span id="local-6989586621679060001"><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679060001"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypedPattern]
</span><a href="#local-6989586621679060001"><span class="hs-identifier hs-var">pt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>   </span><span id="local-6989586621679059999"><span class="annot"><span class="annottext">fromConst :: DList Char -&gt; [Token] -&gt; Maybe FilePath
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var hs-var">fromConst</span></a></span></span><span> </span><span id="local-6989586621679060002"><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060002"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Char -&gt; FilePath
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060002"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>   </span><span class="annot"><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span id="local-6989586621679060003"><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060003"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span id="local-6989586621679060004"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">c</span></a></span></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679060005"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Char -&gt; [Token] -&gt; Maybe FilePath
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060003"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">DList Char -&gt; Char -&gt; DList Char
forall a. DList a -&gt; a -&gt; DList a
</span><span class="hs-operator hs-var">`DL.snoc`</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-382"></span><span>   </span><span class="annot"><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span id="local-6989586621679060006"><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679060007"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679060008"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679060008"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList Char -&gt; [Token] -&gt; Maybe FilePath
</span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Char
</span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">DList Char -&gt; DList Char -&gt; DList Char
forall a. DList a -&gt; DList a -&gt; DList a
</span><span class="hs-operator hs-var">`DL.append`</span></span><span class="annot"><span class="annottext">FilePath -&gt; DList Char
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.fromList</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679060008"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-383"></span><span>   </span><span class="annot"><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">fromConst</span></a></span><span> </span><span class="annot"><span class="annottext">DList Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-384"></span></pre></body></html>