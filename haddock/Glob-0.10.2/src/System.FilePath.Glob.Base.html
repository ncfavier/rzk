<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- File created: 2008-10-10 13:29:26</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.FilePath.Glob.Base</span><span>
</span><span id="line-7"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier">Pattern</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier">CompOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier">MatchOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#compDefault"><span class="hs-identifier">compDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#compPosix"><span class="hs-identifier">compPosix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#matchDefault"><span class="hs-identifier">matchDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#matchPosix"><span class="hs-identifier">matchPosix</span></a></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#decompile"><span class="hs-identifier">decompile</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier">compile</span></a></span><span>
</span><span id="line-15"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#compileWith"><span class="hs-identifier">compileWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#tryCompileWith"><span class="hs-identifier">tryCompileWith</span></a></span><span>
</span><span id="line-16"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokenize"><span class="hs-identifier">tokenize</span></a></span><span> </span><span class="hs-comment">-- for tests</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier">optimize</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#liftP"><span class="hs-identifier">liftP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokToLower"><span class="hs-identifier">tokToLower</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#isLiteral"><span class="hs-identifier">isLiteral</span></a></span><span>
</span><span id="line-23"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwE</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Writer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runWriter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isDigit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isAlpha</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- Monoid is re-exported from Prelude as of 4.8.0.0</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span>                       </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mappend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mempty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mconcat</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if MIN_VERSION_base(4,11,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sconcat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stimes</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">Semigroup</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sconcat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">stimes</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">pathSeparator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">extSeparator</span></span><span>
</span><span id="line-45"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isExtSeparator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPathSeparator</span></span><span>
</span><span id="line-46"></span><span>                                         </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html"><span class="hs-identifier">System.FilePath.Glob.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#dropLeadingZeroes"><span class="hs-identifier">dropLeadingZeroes</span></a></span><span>
</span><span id="line-49"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#isLeft"><span class="hs-identifier">isLeft</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#fromLeft"><span class="hs-identifier">fromLeft</span></a></span><span>
</span><span id="line-50"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#increasingSeq"><span class="hs-identifier">increasingSeq</span></a></span><span>
</span><span id="line-51"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#addToRange"><span class="hs-identifier">addToRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Utils.html#overlap"><span class="hs-identifier">overlap</span></a></span><span>
</span><span id="line-52"></span><span>                                  </span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readPrec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lexP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parens</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Lexeme</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ident</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-59"></span><span>   </span><span class="hs-comment">-- primitives</span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="Literal"><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-61"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="ExtSeparator"><span class="annot"><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span></span><span>                              </span><span class="hs-comment">--  .  optimized away to Literal</span><span>
</span><span id="line-62"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="PathSeparator"><span class="annot"><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span></span><span>                             </span><span class="hs-comment">--  /</span><span>
</span><span id="line-63"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="NonPathSeparator"><span class="annot"><a href="System.FilePath.Glob.Base.html#NonPathSeparator"><span class="hs-identifier hs-var">NonPathSeparator</span></a></span></span><span>                          </span><span class="hs-comment">--  ?</span><span>
</span><span id="line-64"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CharRange"><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--  []</span><span>
</span><span id="line-65"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="OpenRange"><span class="annot"><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">--  &lt;&gt;</span><span>
</span><span id="line-66"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="AnyNonPathSeparator"><span class="annot"><a href="System.FilePath.Glob.Base.html#AnyNonPathSeparator"><span class="hs-identifier hs-var">AnyNonPathSeparator</span></a></span></span><span>                       </span><span class="hs-comment">--  *</span><span>
</span><span id="line-67"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="AnyDirectory"><span class="annot"><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span></span><span>                              </span><span class="hs-comment">--  **/</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>   </span><span class="hs-comment">-- after optimization only</span><span>
</span><span id="line-70"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="LongLiteral"><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-71"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="Unmatchable"><span class="annot"><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span></span><span>  </span><span class="hs-comment">-- [/], or [.] at the beginning or after a path separator</span><span>
</span><span id="line-72"></span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058696"><span id="local-6989586621679058711"><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
(Token -&gt; Token -&gt; Bool) -&gt; (Token -&gt; Token -&gt; Bool) -&gt; Eq Token
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Token -&gt; Token -&gt; Bool
== :: Token -&gt; Token -&gt; Bool
$c/= :: Token -&gt; Token -&gt; Bool
/= :: Token -&gt; Token -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Note: CharRanges aren't converted, because this is tricky in general.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Consider for instance [@-[], which includes the range A-Z. This would need</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- to become [@[a-z]: so essentially we'd need to either:</span><span>
</span><span id="line-77"></span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span class="hs-comment">--    1) Have a list of ranges of uppercase Unicode. Check if our range</span><span>
</span><span id="line-79"></span><span class="hs-comment">--       overlaps with any of them and if it does, take the non-overlapping</span><span>
</span><span id="line-80"></span><span class="hs-comment">--       part and combine it with the toLower of the overlapping part.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">--    2) Simply expand the entire range to a list and map toLower over it.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- In either case we'd need to re-optimize the CharRange&#8212;we can't assume that</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- if the uppercase characters are consecutive, so are the lowercase.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- 1) might be feasible if someone bothered to get the latest data.</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- 2) obviously isn't since you might have 'Right (minBound, maxBound)' in</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- there somewhere.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- The current solution is to just check both the toUpper of the character and</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- the toLower.</span><span>
</span><span id="line-94"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokToLower"><span class="hs-identifier hs-type">tokToLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-95"></span><span id="tokToLower"><span class="annot"><span class="annottext">tokToLower :: Token -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#tokToLower"><span class="hs-identifier hs-var hs-var">tokToLower</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>     </span><span id="local-6989586621679058715"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058715"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058715"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokToLower"><span class="hs-identifier hs-var">tokToLower</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span id="local-6989586621679058716"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058716"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679058717"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058717"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058716"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058717"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokToLower"><span class="hs-identifier hs-var">tokToLower</span></a></span><span> </span><span id="local-6989586621679058718"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679058718"><span class="hs-identifier hs-var">tok</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679058718"><span class="hs-identifier hs-var">tok</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- |An abstract data type representing a compiled pattern.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Note that the 'Eq' instance cannot tell you whether two patterns behave in</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- the same way; only whether they compile to the same 'Pattern'. For instance,</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- @'compile' \&quot;x\&quot;@ and @'compile' \&quot;[x]\&quot;@ may or may not compare equal,</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- though a @'match'@ will behave the exact same way no matter which 'Pattern'</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- is used.</span><span>
</span><span id="line-106"></span><span class="hs-keyword">newtype</span><span> </span><span id="Pattern"><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pattern"><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unPattern"><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var hs-var">unPattern</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058722"><span id="local-6989586621679058726"><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Bool
(Pattern -&gt; Pattern -&gt; Bool)
-&gt; (Pattern -&gt; Pattern -&gt; Bool) -&gt; Eq Pattern
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Pattern -&gt; Pattern -&gt; Bool
== :: Pattern -&gt; Pattern -&gt; Bool
$c/= :: Pattern -&gt; Pattern -&gt; Bool
/= :: Pattern -&gt; Pattern -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#liftP"><span class="hs-identifier hs-type">liftP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-109"></span><span id="liftP"><span class="annot"><span class="annottext">liftP :: ([Token] -&gt; [Token]) -&gt; Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#liftP"><span class="hs-identifier hs-var hs-var">liftP</span></a></span></span><span> </span><span id="local-6989586621679058730"><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679058730"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621679058731"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058731"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679058730"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058731"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058733"><span id="local-6989586621679058737"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>   </span><span id="local-6989586621679058750"><span class="annot"><span class="annottext">show :: Token -&gt; String
</span><a href="#local-6989586621679058750"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span id="local-6989586621679058752"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058752"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058752"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*?[&lt;&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058752"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058752"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058752"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">extSeparator</span></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#NonPathSeparator"><span class="hs-identifier hs-var">NonPathSeparator</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-118"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyNonPathSeparator"><span class="hs-identifier hs-var">AnyNonPathSeparator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-119"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**/&quot;</span></span><span>
</span><span id="line-120"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679058755"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058755"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; String -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; String) -&gt; (Char -&gt; Token) -&gt; Char -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058755"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-121"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-type">OpenRange</span></a></span><span> </span><span id="local-6989586621679058758"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679058758"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679058759"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679058759"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679058758"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679058759"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>   </span><span class="hs-comment">-- We have to be careful here with ^ and ! lest [a!b] become [!ab]. So we</span><span>
</span><span id="line-126"></span><span>   </span><span class="hs-comment">-- just put them at the end.</span><span>
</span><span id="line-127"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span>   </span><span class="hs-comment">-- Also, [^x-] was sorted and should not become [^-x].</span><span>
</span><span id="line-129"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span>   </span><span class="hs-comment">-- Also, for something like [/!^] or /[.^!] that got optimized to have just ^</span><span>
</span><span id="line-131"></span><span>   </span><span class="hs-comment">-- and ! we need to add a dummy /.</span><span>
</span><span id="line-132"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span id="local-6989586621679058760"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058760"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679058761"><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679058761"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058762"><span class="annot"><span class="annottext">f :: Either Char (Char, Char) -&gt; String
</span><a href="#local-6989586621679058762"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String)
-&gt; ((Char, Char) -&gt; String) -&gt; Either Char (Char, Char) -&gt; String
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679058764"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058764"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058765"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058765"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058764"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058765"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679058767"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058767"><span class="hs-identifier hs-var">caret</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058768"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058768"><span class="hs-identifier hs-var">exclamation</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058769"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058769"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>             </span><span class="annot"><span class="annottext">(Either Char (Char, Char)
 -&gt; (String, String, String -&gt; String)
 -&gt; (String, String, String -&gt; String))
-&gt; (String, String, String -&gt; String)
-&gt; CharRange
-&gt; (String, String, String -&gt; String)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679058771"><span class="annot"><span class="annottext">Either Char (Char, Char)
</span><a href="#local-6989586621679058771"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058772"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058772"><span class="hs-identifier hs-var">ca</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058773"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058773"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058774"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058774"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Char (Char, Char)
</span><a href="#local-6989586621679058771"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'^'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058773"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058774"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058772"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058774"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                     </span><span class="annot"><span class="annottext">Either Char (Char, Char)
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058772"><span class="hs-identifier hs-var">ca</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058773"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Char (Char, Char) -&gt; String
</span><a href="#local-6989586621679058762"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Either Char (Char, Char)
</span><a href="#local-6989586621679058771"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058774"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>                   </span><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679058761"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679058778"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058778"><span class="hs-identifier hs-var">beg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058779"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058779"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058780"><span class="annot"><span class="annottext">s' :: String
</span><a href="#local-6989586621679058780"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679058769"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679058781"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058781"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058782"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058782"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058780"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-145"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058760"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058781"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-146"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058782"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058781"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058780"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span>
</span><span id="line-149"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058760"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span>
</span><span id="line-150"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058760"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058778"><span class="hs-identifier hs-var">beg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058767"><span class="hs-identifier hs-var">caret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058768"><span class="hs-identifier hs-var">exclamation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-151"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058778"><span class="hs-identifier hs-var">beg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058767"><span class="hs-identifier hs-var">caret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058768"><span class="hs-identifier hs-var">exclamation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058779"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-152"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-153"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>   </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[.]&quot;</span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058789"><span id="local-6989586621679058793"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>   </span><span id="local-6989586621679058805"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Pattern -&gt; String -&gt; String
</span><a href="#local-6989586621679058805"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679058807"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058807"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679058808"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679058808"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (String -&gt; String) -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058807"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String -&gt; String) -&gt; String -&gt; String)
-&gt; (String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String -&gt; String
forall a. Show a =&gt; Int -&gt; a -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058807"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="System.FilePath.Glob.Base.html#decompile"><span class="hs-identifier hs-var">decompile</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679058808"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058814"><span id="local-6989586621679058818"><span id="local-6989586621679058822"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__
</span><span>   </span><span id="local-6989586621679058835"><span class="annot"><span class="annottext">readPrec :: ReadPrec Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readPrec</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadPrec Pattern -&gt; ReadPrec Pattern
forall a. ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(ReadPrec Pattern -&gt; ReadPrec Pattern)
-&gt; (ReadPrec Pattern -&gt; ReadPrec Pattern)
-&gt; ReadPrec Pattern
-&gt; ReadPrec Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadPrec Pattern -&gt; ReadPrec Pattern
forall a. Int -&gt; ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">prec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(ReadPrec Pattern -&gt; ReadPrec Pattern)
-&gt; ReadPrec Pattern -&gt; ReadPrec Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Ident</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadPrec Lexeme
</span><span class="hs-identifier hs-var">lexP</span></span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">(String -&gt; Pattern) -&gt; ReadPrec String -&gt; ReadPrec Pattern
forall a b. (a -&gt; b) -&gt; ReadPrec a -&gt; ReadPrec b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">ReadPrec String
forall a. Read a =&gt; ReadPrec a
</span><span class="hs-identifier hs-var">readPrec</span></span><span class="hs-cpp">
#else
</span><span>   </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">(</span><span class="hs-string">&quot;compile&quot;</span><span class="hs-special">,</span><span class="hs-identifier">string</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">string</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">compile</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>   </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621679058843"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058843"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679058844"><span class="annot"><span class="annottext">&lt;&gt; :: Pattern -&gt; Pattern -&gt; Pattern
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621679058845"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058845"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058843"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058845"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>   </span><span id="local-6989586621679058847"><span class="annot"><span class="annottext">sconcat :: NonEmpty Pattern -&gt; Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; (NonEmpty Pattern -&gt; Pattern) -&gt; NonEmpty Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern)
-&gt; (NonEmpty Pattern -&gt; [Token]) -&gt; NonEmpty Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; [Token]) -&gt; [Pattern] -&gt; [Token]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; [Token])
-&gt; (NonEmpty Pattern -&gt; [Pattern]) -&gt; NonEmpty Pattern -&gt; [Token]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Pattern -&gt; [Pattern]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-176"></span><span>   </span><span id="local-6989586621679058851"><span class="annot"><span class="annottext">stimes :: forall b. Integral b =&gt; b -&gt; Pattern -&gt; Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">stimes</span></span></span><span> </span><span id="local-6989586621679058852"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058852"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621679058853"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058853"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; [Token] -&gt; [Token]
forall b. Integral b =&gt; b -&gt; [Token] -&gt; [Token]
forall a b. (Semigroup a, Integral b) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimes</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058852"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679058853"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>   </span><span id="local-6989586621679058861"><span class="annot"><span class="annottext">mempty :: Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>   </span><span id="local-6989586621679058863"><span class="annot"><span class="annottext">mappend :: Pattern -&gt; Pattern -&gt; Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Pattern
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-181"></span><span>   </span><span id="local-6989586621679058865"><span class="annot"><span class="annottext">mconcat :: [Pattern] -&gt; Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; ([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern)
-&gt; ([Pattern] -&gt; [Token]) -&gt; [Pattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; [Token]) -&gt; [Pattern] -&gt; [Token]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679058869"><span class="annot"><span class="annottext">fromString :: String -&gt; Pattern
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- |Options which can be passed to the 'tryCompileWith' or 'compileWith'</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- functions: with these you can selectively toggle certain features at compile</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- time.</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- Note that some of these options depend on each other: classes can never</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- occur if ranges aren't allowed, for instance.</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- We could presumably put locale information in here, too.</span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="CompOptions"><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-var">CompOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompOptions"><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-var">CompOptions</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="characterClasses"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#characterClasses"><span class="hs-identifier hs-var hs-var">characterClasses</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^Allow character classes, @[[:...:]]@.</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="characterRanges"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#characterRanges"><span class="hs-identifier hs-var hs-var">characterRanges</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^Allow character ranges, @[...]@.</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="numberRanges"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#numberRanges"><span class="hs-identifier hs-var hs-var">numberRanges</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^Allow open ranges, @\&lt;...&gt;@.</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="wildcards"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#wildcards"><span class="hs-identifier hs-var hs-var">wildcards</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^Allow wildcards, @*@ and @?@.</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="recursiveWildcards"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#recursiveWildcards"><span class="hs-identifier hs-var hs-var">recursiveWildcards</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^Allow recursive wildcards, @**/@.</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="pathSepInRanges"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#pathSepInRanges"><span class="hs-identifier hs-var hs-var">pathSepInRanges</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-comment">-- ^Allow path separators in character ranges.</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-comment">-- If true, @a[/]b@ never matches anything (since character ranges can't</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-comment">-- match path separators); if false and 'errorRecovery' is enabled,</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-comment">-- @a[/]b@ matches itself, i.e. a file named @]b@ in the subdirectory</span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-comment">-- @a[@.</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="errorRecovery"><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#errorRecovery"><span class="hs-identifier hs-var hs-var">errorRecovery</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-comment">-- ^If the input is invalid, recover by turning any invalid part into</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-comment">-- literals. For instance, with 'characterRanges' enabled, @[abc@ is an</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-comment">-- error by default (unclosed character range); with 'errorRecovery', the</span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- @[@ is turned into a literal match, as though 'characterRanges' were</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-comment">-- disabled.</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058879"><span id="local-6989586621679058890"><span id="local-6989586621679058894"><span class="annot"><span class="annottext">Int -&gt; CompOptions -&gt; String -&gt; String
[CompOptions] -&gt; String -&gt; String
CompOptions -&gt; String
(Int -&gt; CompOptions -&gt; String -&gt; String)
-&gt; (CompOptions -&gt; String)
-&gt; ([CompOptions] -&gt; String -&gt; String)
-&gt; Show CompOptions
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; CompOptions -&gt; String -&gt; String
showsPrec :: Int -&gt; CompOptions -&gt; String -&gt; String
$cshow :: CompOptions -&gt; String
show :: CompOptions -&gt; String
$cshowList :: [CompOptions] -&gt; String -&gt; String
showList :: [CompOptions] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679058897"><span id="local-6989586621679058901"><span id="local-6989586621679058904"><span id="local-6989586621679058931"><span class="annot"><span class="annottext">ReadPrec [CompOptions]
ReadPrec CompOptions
Int -&gt; ReadS CompOptions
ReadS [CompOptions]
(Int -&gt; ReadS CompOptions)
-&gt; ReadS [CompOptions]
-&gt; ReadPrec CompOptions
-&gt; ReadPrec [CompOptions]
-&gt; Read CompOptions
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS CompOptions
readsPrec :: Int -&gt; ReadS CompOptions
$creadList :: ReadS [CompOptions]
readList :: ReadS [CompOptions]
$creadPrec :: ReadPrec CompOptions
readPrec :: ReadPrec CompOptions
$creadListPrec :: ReadPrec [CompOptions]
readListPrec :: ReadPrec [CompOptions]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679058934"><span id="local-6989586621679058943"><span class="annot"><span class="annottext">CompOptions -&gt; CompOptions -&gt; Bool
(CompOptions -&gt; CompOptions -&gt; Bool)
-&gt; (CompOptions -&gt; CompOptions -&gt; Bool) -&gt; Eq CompOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CompOptions -&gt; CompOptions -&gt; Bool
== :: CompOptions -&gt; CompOptions -&gt; Bool
$c/= :: CompOptions -&gt; CompOptions -&gt; Bool
/= :: CompOptions -&gt; CompOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- |The default set of compilation options: closest to the behaviour of the</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- @zsh@ shell, with 'errorRecovery' enabled.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- All options are enabled.</span><span>
</span><span id="line-221"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#compDefault"><span class="hs-identifier hs-type">compDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span>
</span><span id="line-222"></span><span id="compDefault"><span class="annot"><span class="annottext">compDefault :: CompOptions
</span><a href="System.FilePath.Glob.Base.html#compDefault"><span class="hs-identifier hs-var hs-var">compDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span>
</span><span id="line-223"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">characterClasses :: Bool
</span><a href="System.FilePath.Glob.Base.html#characterClasses"><span class="hs-identifier hs-var">characterClasses</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-224"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">characterRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#characterRanges"><span class="hs-identifier hs-var">characterRanges</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-225"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numberRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#numberRanges"><span class="hs-identifier hs-var">numberRanges</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-226"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wildcards :: Bool
</span><a href="System.FilePath.Glob.Base.html#wildcards"><span class="hs-identifier hs-var">wildcards</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-227"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recursiveWildcards :: Bool
</span><a href="System.FilePath.Glob.Base.html#recursiveWildcards"><span class="hs-identifier hs-var">recursiveWildcards</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-228"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pathSepInRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#pathSepInRanges"><span class="hs-identifier hs-var">pathSepInRanges</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-229"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errorRecovery :: Bool
</span><a href="System.FilePath.Glob.Base.html#errorRecovery"><span class="hs-identifier hs-var">errorRecovery</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-230"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- |Options for POSIX-compliance, as described in @man 7 glob@.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- 'numberRanges', 'recursiveWildcards', and 'pathSepInRanges' are disabled.</span><span>
</span><span id="line-235"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#compPosix"><span class="hs-identifier hs-type">compPosix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span>
</span><span id="line-236"></span><span id="compPosix"><span class="annot"><span class="annottext">compPosix :: CompOptions
</span><a href="System.FilePath.Glob.Base.html#compPosix"><span class="hs-identifier hs-var hs-var">compPosix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span>
</span><span id="line-237"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">characterClasses :: Bool
</span><a href="System.FilePath.Glob.Base.html#characterClasses"><span class="hs-identifier hs-var">characterClasses</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-238"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">characterRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#characterRanges"><span class="hs-identifier hs-var">characterRanges</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-239"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numberRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#numberRanges"><span class="hs-identifier hs-var">numberRanges</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-240"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wildcards :: Bool
</span><a href="System.FilePath.Glob.Base.html#wildcards"><span class="hs-identifier hs-var">wildcards</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-241"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recursiveWildcards :: Bool
</span><a href="System.FilePath.Glob.Base.html#recursiveWildcards"><span class="hs-identifier hs-var">recursiveWildcards</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-242"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pathSepInRanges :: Bool
</span><a href="System.FilePath.Glob.Base.html#pathSepInRanges"><span class="hs-identifier hs-var">pathSepInRanges</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-243"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errorRecovery :: Bool
</span><a href="System.FilePath.Glob.Base.html#errorRecovery"><span class="hs-identifier hs-var">errorRecovery</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-244"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- |Options which can be passed to the 'matchWith' or 'globDirWith' functions:</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- with these you can selectively toggle certain features at matching time.</span><span>
</span><span id="line-248"></span><span class="hs-keyword">data</span><span> </span><span id="MatchOptions"><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-var">MatchOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MatchOptions"><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-var">MatchOptions</span></a></span></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="matchDotsImplicitly"><span class="annot"><span class="annottext">MatchOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#matchDotsImplicitly"><span class="hs-identifier hs-var hs-var">matchDotsImplicitly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-comment">-- ^Allow @*@, @?@, and @**/@ to match @.@ at the beginning of paths.</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ignoreCase"><span class="annot"><span class="annottext">MatchOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#ignoreCase"><span class="hs-identifier hs-var hs-var">ignoreCase</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-comment">-- ^Case-independent matching.</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ignoreDotSlash"><span class="annot"><span class="annottext">MatchOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#ignoreDotSlash"><span class="hs-identifier hs-var hs-var">ignoreDotSlash</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-comment">-- ^Treat @./@ as a no-op in both paths and patterns.</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-comment">-- (Of course e.g. @../@ means something different and will not be</span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-comment">-- ignored.)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- |The default set of execution options: closest to the behaviour of the @zsh@</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- shell.</span><span>
</span><span id="line-264"></span><span class="hs-comment">--</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Currently identical to 'matchPosix'.</span><span>
</span><span id="line-266"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#matchDefault"><span class="hs-identifier hs-type">matchDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-type">MatchOptions</span></a></span><span>
</span><span id="line-267"></span><span id="matchDefault"><span class="annot"><span class="annottext">matchDefault :: MatchOptions
</span><a href="System.FilePath.Glob.Base.html#matchDefault"><span class="hs-identifier hs-var hs-var">matchDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchOptions
</span><a href="System.FilePath.Glob.Base.html#matchPosix"><span class="hs-identifier hs-var">matchPosix</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- |Options for POSIX-compliance, as described in @man 7 glob@.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- 'ignoreDotSlash' is enabled, the rest are disabled.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#matchPosix"><span class="hs-identifier hs-type">matchPosix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-type">MatchOptions</span></a></span><span>
</span><span id="line-273"></span><span id="matchPosix"><span class="annot"><span class="annottext">matchPosix :: MatchOptions
</span><a href="System.FilePath.Glob.Base.html#matchPosix"><span class="hs-identifier hs-var hs-var">matchPosix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#MatchOptions"><span class="hs-identifier hs-type">MatchOptions</span></a></span><span>
</span><span id="line-274"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">matchDotsImplicitly :: Bool
</span><a href="System.FilePath.Glob.Base.html#matchDotsImplicitly"><span class="hs-identifier hs-var">matchDotsImplicitly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-275"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ignoreCase :: Bool
</span><a href="System.FilePath.Glob.Base.html#ignoreCase"><span class="hs-identifier hs-var">ignoreCase</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-276"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ignoreDotSlash :: Bool
</span><a href="System.FilePath.Glob.Base.html#ignoreDotSlash"><span class="hs-identifier hs-var">ignoreDotSlash</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-277"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- |Decompiles a 'Pattern' object into its textual representation: essentially</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- the inverse of 'compile'.</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- Note, however, that due to internal optimization, @decompile . compile@ is</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- not the identity function. Instead, @compile . decompile@ is.</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Be careful with 'CompOptions': 'decompile' always produces a 'String' which</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- can be passed to 'compile' to get back the same 'Pattern'. @compileWith</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- options . decompile@ is /not/ the identity function unless @options@ is</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- 'compDefault'.</span><span>
</span><span id="line-289"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#decompile"><span class="hs-identifier hs-type">decompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-290"></span><span id="decompile"><span class="annot"><span class="annottext">decompile :: Pattern -&gt; String
</span><a href="System.FilePath.Glob.Base.html#decompile"><span class="hs-identifier hs-var hs-var">decompile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; String) -&gt; [Token] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; String) -&gt; (Pattern -&gt; [Token]) -&gt; Pattern -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">------------------------------------------</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- COMPILATION</span><span>
</span><span id="line-294"></span><span class="hs-comment">------------------------------------------</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- |Compiles a glob pattern from its textual representation into a 'Pattern'</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- object.</span><span>
</span><span id="line-299"></span><span class="hs-comment">--</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- For the most part, a character matches itself. Recognized operators are as</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- follows:</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- [@?@]      Matches any character except path separators.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- [@*@]      Matches any number of characters except path separators,</span><span>
</span><span id="line-306"></span><span class="hs-comment">--            including the empty string.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- [@[..\]@]  Matches any of the enclosed characters. Ranges of characters can</span><span>
</span><span id="line-309"></span><span class="hs-comment">--            be specified by separating the endpoints with a @\'-'@. @\'-'@ or</span><span>
</span><span id="line-310"></span><span class="hs-comment">--            @']'@ can be matched by including them as the first character(s)</span><span>
</span><span id="line-311"></span><span class="hs-comment">--            in the list. Never matches path separators: @[\/]@ matches</span><span>
</span><span id="line-312"></span><span class="hs-comment">--            nothing at all. Named character classes can also be matched:</span><span>
</span><span id="line-313"></span><span class="hs-comment">--            @[:x:]@ within @[]@ specifies the class named @x@, which matches</span><span>
</span><span id="line-314"></span><span class="hs-comment">--            certain predefined characters. See below for a full list.</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- [@[^..\]@ or @[!..\]@] Like @[..]@, but matches any character /not/ listed.</span><span>
</span><span id="line-317"></span><span class="hs-comment">--                        Note that @[^-x]@ is not the inverse of @[-x]@, but</span><span>
</span><span id="line-318"></span><span class="hs-comment">--                        the range @[^-x]@.</span><span>
</span><span id="line-319"></span><span class="hs-comment">--</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- [@\&lt;m-n&gt;@] Matches any integer in the range m to n, inclusive. The range may</span><span>
</span><span id="line-321"></span><span class="hs-comment">--            be open-ended by leaving out either number: @\&quot;\&lt;-&gt;\&quot;@, for</span><span>
</span><span id="line-322"></span><span class="hs-comment">--            instance, matches any integer.</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- [@**/@]    Matches any number of characters, including path separators,</span><span>
</span><span id="line-325"></span><span class="hs-comment">--            excluding the empty string.</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- Supported character classes:</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- [@[:alnum:\]@]  Equivalent to @\&quot;0-9A-Za-z\&quot;@.</span><span>
</span><span id="line-330"></span><span class="hs-comment">--</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- [@[:alpha:\]@]  Equivalent to @\&quot;A-Za-z\&quot;@.</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- [@[:blank:\]@]  Equivalent to @\&quot;\\t \&quot;@.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- [@[:cntrl:\]@]  Equivalent to @\&quot;\\0-\\x1f\\x7f\&quot;@.</span><span>
</span><span id="line-336"></span><span class="hs-comment">--</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- [@[:digit:\]@]  Equivalent to @\&quot;0-9\&quot;@.</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- [@[:graph:\]@]  Equivalent to @\&quot;!-~\&quot;@.</span><span>
</span><span id="line-340"></span><span class="hs-comment">--</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- [@[:lower:\]@]  Equivalent to @\&quot;a-z\&quot;@.</span><span>
</span><span id="line-342"></span><span class="hs-comment">--</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- [@[:print:\]@]  Equivalent to @\&quot; -~\&quot;@.</span><span>
</span><span id="line-344"></span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- [@[:punct:\]@]  Equivalent to @\&quot;!-\/:-\@[-`{-~\&quot;@.</span><span>
</span><span id="line-346"></span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- [@[:space:\]@]  Equivalent to @\&quot;\\t-\\r \&quot;@.</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- [@[:upper:\]@]  Equivalent to @\&quot;A-Z\&quot;@.</span><span>
</span><span id="line-350"></span><span class="hs-comment">--</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- [@[:xdigit:\]@] Equivalent to @\&quot;0-9A-Fa-f\&quot;@.</span><span>
</span><span id="line-352"></span><span class="hs-comment">--</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Note that path separators (typically @\'/\'@) have to be matched explicitly</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- or using the @**/@ pattern. In addition, extension separators (typically</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- @\'.\'@) have to be matched explicitly at the beginning of the pattern or</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- after any path separator.</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- If a system supports multiple path separators, any one of them will match</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- any of them. For instance, on Windows, @\'/\'@ will match itself as well as</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- @\'\\\'@.</span><span>
</span><span id="line-361"></span><span class="hs-comment">--</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- Error recovery will be performed: erroneous operators will not be considered</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- operators, but matched as literal strings. Such operators include:</span><span>
</span><span id="line-364"></span><span class="hs-comment">--</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- * An empty @[]@ or @[^]@ or @[!]@</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- * A @[@ or @\&lt;@ without a matching @]@ or @&gt;@</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- * A malformed @\&lt;&gt;@: e.g. nonnumeric characters or no hyphen</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- So, e.g. @[]@ will match the string @\&quot;[]\&quot;@.</span><span>
</span><span id="line-372"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-373"></span><span id="compile"><span class="annot"><span class="annottext">compile :: String -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; String -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compileWith"><span class="hs-identifier hs-var">compileWith</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="System.FilePath.Glob.Base.html#compDefault"><span class="hs-identifier hs-var">compDefault</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- |Like 'compile', but recognizes operators according to the given</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- 'CompOptions' instead of the defaults.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- If an error occurs and 'errorRecovery' is disabled, 'error' will be called.</span><span>
</span><span id="line-379"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#compileWith"><span class="hs-identifier hs-type">compileWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-380"></span><span id="compileWith"><span class="annot"><span class="annottext">compileWith :: CompOptions -&gt; String -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#compileWith"><span class="hs-identifier hs-var hs-var">compileWith</span></a></span></span><span> </span><span id="local-6989586621679058951"><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058951"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Pattern)
-&gt; (Pattern -&gt; Pattern) -&gt; Either String Pattern -&gt; Pattern
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Pattern
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Either String Pattern -&gt; Pattern)
-&gt; (String -&gt; Either String Pattern) -&gt; String -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; String -&gt; Either String Pattern
</span><a href="System.FilePath.Glob.Base.html#tryCompileWith"><span class="hs-identifier hs-var">tryCompileWith</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058951"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- |A safe version of 'compileWith'.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- If an error occurs and 'errorRecovery' is disabled, the error message will</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- be returned in a 'Left'.</span><span>
</span><span id="line-386"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#tryCompileWith"><span class="hs-identifier hs-type">tryCompileWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-387"></span><span id="tryCompileWith"><span class="annot"><span class="annottext">tryCompileWith :: CompOptions -&gt; String -&gt; Either String Pattern
</span><a href="System.FilePath.Glob.Base.html#tryCompileWith"><span class="hs-identifier hs-var hs-var">tryCompileWith</span></a></span></span><span> </span><span id="local-6989586621679058952"><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; Either String Pattern -&gt; Either String Pattern
forall a b. (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var">optimize</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String Pattern -&gt; Either String Pattern)
-&gt; (String -&gt; Either String Pattern)
-&gt; String
-&gt; Either String Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; String -&gt; Either String Pattern
</span><a href="System.FilePath.Glob.Base.html#tokenize"><span class="hs-identifier hs-var">tokenize</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#tokenize"><span class="hs-identifier hs-type">tokenize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-390"></span><span id="tokenize"><span class="annot"><span class="annottext">tokenize :: CompOptions -&gt; String -&gt; Either String Pattern
</span><a href="System.FilePath.Glob.Base.html#tokenize"><span class="hs-identifier hs-var hs-var">tokenize</span></a></span></span><span> </span><span id="local-6989586621679058953"><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern)
-&gt; Either String [Token] -&gt; Either String Pattern
forall a b. (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String [Token] -&gt; Either String Pattern)
-&gt; (String -&gt; Either String [Token])
-&gt; String
-&gt; Either String Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Either String Token] -&gt; Either String [Token]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([Either String Token] -&gt; Either String [Token])
-&gt; (String -&gt; [Either String Token])
-&gt; String
-&gt; Either String [Token]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-391"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>   </span><span id="local-6989586621679058956"><span class="annot"><span class="annottext">err :: String -&gt; Char -&gt; String -&gt; [Either String Token]
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679058957"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058957"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679058958"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#errorRecovery"><span class="hs-identifier hs-var">errorRecovery</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058957"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-393"></span><span>   </span><span class="annot"><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span id="local-6989586621679058959"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058959"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Either String Token
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058959"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>   </span><span id="local-6989586621679058955"><span class="annot"><span class="annottext">go :: String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058960"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058960"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058961"><span class="hs-identifier hs-var">wcs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#NonPathSeparator"><span class="hs-identifier hs-var">NonPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058960"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-398"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058962"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058961"><span class="hs-identifier hs-var">wcs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-400"></span><span>           </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058963"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058963"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058964"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058964"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058965"><span class="hs-identifier hs-var">rwcs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058963"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-401"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span><span>        </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058964"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-402"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyNonPathSeparator"><span class="hs-identifier hs-var">AnyNonPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058966"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058966"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058967"><span class="hs-identifier hs-var">crs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058968"><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058968"><span class="hs-identifier hs-var">range</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058969"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058969"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; String -&gt; (Either String Token, String)
</span><a href="System.FilePath.Glob.Base.html#charRange"><span class="hs-identifier hs-var">charRange</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058966"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-405"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058968"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-406"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679058971"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058971"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; String -&gt; [Either String Token]
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058971"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058966"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-407"></span><span>                                </span><span id="local-6989586621679058972"><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058972"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058972"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058969"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058973"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058974"><span class="hs-identifier hs-var">ors</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058976"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058976"><span class="hs-identifier hs-var">range</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058977"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-411"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058977"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-412"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; String -&gt; [Either String Token]
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: unclosed &lt;&gt; in pattern&quot;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-413"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Token
</span><a href="System.FilePath.Glob.Base.html#openRange"><span class="hs-identifier hs-var">openRange</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058976"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>                       </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679058980"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058980"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; String -&gt; [Either String Token]
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058980"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-415"></span><span>                       </span><span id="local-6989586621679058981"><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058981"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String Token
</span><a href="#local-6989586621679058981"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058977"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>   </span><span class="annot"><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058983"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058983"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058984"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058984"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058983"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058984"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isExtSeparator</span></span><span>  </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058983"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>  </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058984"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058983"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">Either String Token
-&gt; [Either String Token] -&gt; [Either String Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Either String Token]
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058984"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>   </span><span id="local-6989586621679058961"><span class="annot"><span class="annottext">wcs :: Bool
</span><a href="#local-6989586621679058961"><span class="hs-identifier hs-var hs-var">wcs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#wildcards"><span class="hs-identifier hs-var">wildcards</span></a></span><span>          </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-422"></span><span>   </span><span id="local-6989586621679058965"><span class="annot"><span class="annottext">rwcs :: Bool
</span><a href="#local-6989586621679058965"><span class="hs-identifier hs-var hs-var">rwcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#recursiveWildcards"><span class="hs-identifier hs-var">recursiveWildcards</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-423"></span><span>   </span><span id="local-6989586621679058967"><span class="annot"><span class="annottext">crs :: Bool
</span><a href="#local-6989586621679058967"><span class="hs-identifier hs-var hs-var">crs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#characterRanges"><span class="hs-identifier hs-var">characterRanges</span></a></span><span>    </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-424"></span><span>   </span><span id="local-6989586621679058974"><span class="annot"><span class="annottext">ors :: Bool
</span><a href="#local-6989586621679058974"><span class="hs-identifier hs-var hs-var">ors</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#numberRanges"><span class="hs-identifier hs-var">numberRanges</span></a></span><span>       </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- &lt;a-b&gt; where a &gt; b can never match anything; this is not considered an error</span><span>
</span><span id="line-427"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#openRange"><span class="hs-identifier hs-type">openRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-428"></span><span id="openRange"><span class="annot"><span class="annottext">openRange :: String -&gt; Either String Token
</span><a href="System.FilePath.Glob.Base.html#openRange"><span class="hs-identifier hs-var hs-var">openRange</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Either String Token) -&gt; Token -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-429"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#openRange"><span class="hs-identifier hs-var">openRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058985"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058985"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058985"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679058987"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058987"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Either String Token) -&gt; Token -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
</span><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-var">openRangeNum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058987"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">(String, String)
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Token
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Token) -&gt; String -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: bad &lt;&gt;, expected number, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058985"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-433"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#openRange"><span class="hs-identifier hs-var">openRange</span></a></span><span> </span><span id="local-6989586621679058989"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058989"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-434"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058989"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679058990"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058990"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Either String Token) -&gt; Token -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
</span><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-var">openRangeNum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058990"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679058991"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058991"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058992"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058992"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058992"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-438"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679058993"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058993"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Either String Token) -&gt; Token -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
</span><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-var">openRangeNum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058991"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
</span><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-var">openRangeNum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058993"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                </span><span class="annot"><span class="annottext">(String, String)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Token
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Token) -&gt; String -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: bad &lt;&gt;, expected number, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058992"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="annottext">(String, String)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Token
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Token) -&gt; String -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: bad &lt;&gt;, expected number followed by - in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058989"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-type">openRangeNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-443"></span><span id="openRangeNum"><span class="annot"><span class="annottext">openRangeNum :: String -&gt; Maybe String
</span><a href="System.FilePath.Glob.Base.html#openRangeNum"><span class="hs-identifier hs-var hs-var">openRangeNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String)
-&gt; (String -&gt; String) -&gt; String -&gt; Maybe String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="System.FilePath.Glob.Utils.html#dropLeadingZeroes"><span class="hs-identifier hs-var">dropLeadingZeroes</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-keyword">type</span><span> </span><span id="CharRange"><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#charRange"><span class="hs-identifier hs-type">charRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CompOptions"><span class="hs-identifier hs-type">CompOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span id="charRange"><span class="annot"><span class="annottext">charRange :: CompOptions -&gt; String -&gt; (Either String Token, String)
</span><a href="System.FilePath.Glob.Base.html#charRange"><span class="hs-identifier hs-var hs-var">charRange</span></a></span></span><span> </span><span id="local-6989586621679058994"><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058994"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679058995"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058995"><span class="hs-identifier hs-var">zs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058995"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-450"></span><span>        </span><span id="local-6989586621679058996"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058996"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058997"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058997"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679058996"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^!&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058997"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-452"></span><span>                </span><span class="hs-comment">-- [!-#] is not the inverse of [-#], it is the range ! through</span><span>
</span><span id="line-453"></span><span>                </span><span class="hs-comment">-- #</span><span>
</span><span id="line-454"></span><span>                </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679058998"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Either String Token
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>                </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Either String CharRange -&gt; Either String Token)
-&gt; (Either String CharRange, String)
-&gt; (Either String Token, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CharRange -&gt; Token)
-&gt; Either String CharRange -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058995"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>                </span><span id="local-6989586621679059000"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059000"><span class="hs-identifier hs-var">xs</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Either String CharRange -&gt; Either String Token)
-&gt; (Either String CharRange, String)
-&gt; (Either String Token, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CharRange -&gt; Token)
-&gt; Either String CharRange -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059000"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Either String CharRange -&gt; Either String Token)
-&gt; (Either String CharRange, String)
-&gt; (Either String Token, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CharRange -&gt; Token)
-&gt; Either String CharRange -&gt; Either String Token
forall a b. (a -&gt; b) -&gt; Either String a -&gt; Either String b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679058995"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-459"></span><span>   </span><span class="annot"><a href="#local-6989586621679058999"><span class="hs-identifier hs-type">start</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>   </span><span id="local-6989586621679058999"><span class="annot"><span class="annottext">start :: String -&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679058999"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059001"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059001"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679059002"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT String (Writer CharRange) String
 -&gt; (Either String CharRange, String))
-&gt; ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059001"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-461"></span><span>   </span><span class="annot"><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059004"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059004"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679059002"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT String (Writer CharRange) String
 -&gt; (Either String CharRange, String))
-&gt; ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059004"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-462"></span><span>   </span><span class="annot"><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span id="local-6989586621679059005"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059005"><span class="hs-identifier hs-var">xs</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679059002"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT String (Writer CharRange) String
 -&gt; (Either String CharRange, String))
-&gt; ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059005"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>   </span><span class="annot"><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">run</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-465"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>   </span><span id="local-6989586621679059002"><span class="annot"><span class="annottext">run :: ExceptT String (Writer CharRange) String
-&gt; (Either String CharRange, String)
</span><a href="#local-6989586621679059002"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679059007"><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Writer CharRange (Either String String)
-&gt; (Either String String, CharRange)
forall w a. Writer w a -&gt; (a, w)
</span><span class="hs-identifier hs-var">runWriter</span></span><span class="annot"><span class="annottext">(Writer CharRange (Either String String)
 -&gt; (Either String String, CharRange))
-&gt; (ExceptT String (Writer CharRange) String
    -&gt; Writer CharRange (Either String String))
-&gt; ExceptT String (Writer CharRange) String
-&gt; (Either String String, CharRange)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
-&gt; Writer CharRange (Either String String)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT String (Writer CharRange) String
 -&gt; (Either String String, CharRange))
-&gt; ExceptT String (Writer CharRange) String
-&gt; (Either String String, CharRange)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-467"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059008"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059008"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">CharRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Either String CharRange
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059008"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679059009"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059009"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059010"><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059010"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CharRange -&gt; Either String CharRange
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059010"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059009"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>   </span><span class="annot"><a href="#local-6989586621679059006"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-471"></span><span>   </span><span id="local-6989586621679059006"><span class="annot"><span class="annottext">go :: String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059011"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059011"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#characterClasses"><span class="hs-identifier hs-var">characterClasses</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058994"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059012"><span class="hs-identifier hs-var">readClass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059011"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-472"></span><span>   </span><span class="annot"><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span>    </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059013"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059013"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
forall a. a -&gt; ExceptT String (Writer CharRange) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059013"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-473"></span><span>   </span><span class="annot"><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span>      </span><span id="local-6989586621679059014"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059014"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059015"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059015"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompOptions -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#pathSepInRanges"><span class="hs-identifier hs-var">pathSepInRanges</span></a></span><span> </span><span class="annot"><span class="annottext">CompOptions
</span><a href="#local-6989586621679058994"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059014"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-475"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: path separator within []&quot;</span></span><span>
</span><span id="line-476"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059014"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059015"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-477"></span><span>   </span><span class="annot"><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: unclosed [] in pattern&quot;</span></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>   </span><span class="annot"><a href="#local-6989586621679059003"><span class="hs-identifier hs-type">char</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-480"></span><span>   </span><span id="local-6989586621679059003"><span class="annot"><span class="annottext">char :: Char -&gt; String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var hs-var">char</span></a></span></span><span> </span><span id="local-6989586621679059016"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059016"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059017"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059017"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059018"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059018"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059017"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-482"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059016"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) ()
-&gt; ExceptT String (Writer CharRange) String
-&gt; ExceptT String (Writer CharRange) String
forall a b.
ExceptT String (Writer CharRange) a
-&gt; ExceptT String (Writer CharRange) b
-&gt; ExceptT String (Writer CharRange) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
forall a. a -&gt; ExceptT String (Writer CharRange) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059018"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-483"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059016"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059017"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>      </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) ()
-&gt; ExceptT String (Writer CharRange) String
-&gt; ExceptT String (Writer CharRange) String
forall a b.
ExceptT String (Writer CharRange) a
-&gt; ExceptT String (Writer CharRange) b
-&gt; ExceptT String (Writer CharRange) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>     </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059018"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>   </span><span class="annot"><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span id="local-6989586621679059020"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059020"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679059021"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059021"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059020"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) ()
-&gt; ExceptT String (Writer CharRange) String
-&gt; ExceptT String (Writer CharRange) String
forall a b.
ExceptT String (Writer CharRange) a
-&gt; ExceptT String (Writer CharRange) b
-&gt; ExceptT String (Writer CharRange) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059021"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>   </span><span class="annot"><a href="#local-6989586621679059012"><span class="hs-identifier hs-type">readClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-488"></span><span>   </span><span id="local-6989586621679059012"><span class="annot"><span class="annottext">readClass :: String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059012"><span class="hs-identifier hs-var hs-var">readClass</span></a></span></span><span> </span><span id="local-6989586621679059022"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059022"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059023"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059023"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059024"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059024"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059022"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-489"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059024"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-490"></span><span>                           </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059025"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059025"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059026"><span class="hs-identifier hs-var">charClass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059023"><span class="hs-identifier hs-var">name</span></a></span><span>            </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) ()
-&gt; ExceptT String (Writer CharRange) String
-&gt; ExceptT String (Writer CharRange) String
forall a b.
ExceptT String (Writer CharRange) a
-&gt; ExceptT String (Writer CharRange) b
-&gt; ExceptT String (Writer CharRange) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059025"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-491"></span><span>                           </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ExceptT String (Writer CharRange) ()
-&gt; ExceptT String (Writer CharRange) String
-&gt; ExceptT String (Writer CharRange) String
forall a b.
ExceptT String (Writer CharRange) a
-&gt; ExceptT String (Writer CharRange) b
-&gt; ExceptT String (Writer CharRange) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) String
</span><a href="#local-6989586621679059006"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059022"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span>   </span><span class="annot"><a href="#local-6989586621679059026"><span class="hs-identifier hs-type">charClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>   </span><span id="local-6989586621679059026"><span class="annot"><span class="annottext">charClass :: String -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059026"><span class="hs-identifier hs-var hs-var">charClass</span></a></span></span><span> </span><span id="local-6989586621679059027"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059027"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-comment">-- The POSIX classes</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-comment">-- TODO: this is ASCII-only, not sure how this should be extended</span><span>
</span><span id="line-498"></span><span>      </span><span class="hs-comment">--       Unicode, or with a locale as input, or something else?</span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059027"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-500"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;alnum&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var">digit</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059029"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059030"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-501"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;alpha&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059029"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059030"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-502"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;blank&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="annot"><span class="annottext">CharRange
forall {b}. [Either Char b]
</span><a href="#local-6989586621679059031"><span class="hs-identifier hs-var">blanks</span></a></span><span>
</span><span id="line-503"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cntrl&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\0'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\x1f'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\x7f'</span></span><span class="hs-special">]</span><span>
</span><span id="line-504"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;digit&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var">digit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;graph&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-506"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lower&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059030"><span class="hs-identifier hs-var">lower</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-507"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;print&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;punct&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="annot"><span class="annottext">CharRange
forall {a}. [Either a (Char, Char)]
</span><a href="#local-6989586621679059032"><span class="hs-identifier hs-var">punct</span></a></span><span>
</span><span id="line-509"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;space&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059033"><span class="hs-identifier hs-var">spaces</span></a></span><span>
</span><span id="line-510"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;upper&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059029"><span class="hs-identifier hs-var">upper</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-511"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xdigit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var">ltell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Char (Char, Char)
forall {a}. Either a (Char, Char)
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var">digit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'F'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span>           </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; ExceptT String (Writer CharRange) ()
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile :: unknown character class '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059027"><span class="hs-identifier hs-var">name</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>   </span><span id="local-6989586621679059028"><span class="annot"><span class="annottext">digit :: Either a (Char, Char)
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var hs-var">digit</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either a (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>   </span><span id="local-6989586621679059029"><span class="annot"><span class="annottext">upper :: Either a (Char, Char)
</span><a href="#local-6989586621679059029"><span class="hs-identifier hs-var hs-var">upper</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either a (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>   </span><span id="local-6989586621679059030"><span class="annot"><span class="annottext">lower :: Either a (Char, Char)
</span><a href="#local-6989586621679059030"><span class="hs-identifier hs-var hs-var">lower</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either a (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>   </span><span id="local-6989586621679059032"><span class="annot"><span class="annottext">punct :: [Either a (Char, Char)]
</span><a href="#local-6989586621679059032"><span class="hs-identifier hs-var hs-var">punct</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Char, Char) -&gt; Either a (Char, Char))
-&gt; [(Char, Char)] -&gt; [Either a (Char, Char)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either a (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-519"></span><span>   </span><span id="local-6989586621679059031"><span class="annot"><span class="annottext">blanks :: [Either Char b]
</span><a href="#local-6989586621679059031"><span class="hs-identifier hs-var hs-var">blanks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Either Char b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Char -&gt; Either Char b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>   </span><span id="local-6989586621679059033"><span class="annot"><span class="annottext">spaces :: CharRange
</span><a href="#local-6989586621679059033"><span class="hs-identifier hs-var hs-var">spaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\r'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Char (Char, Char)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">]</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span>   </span><span id="local-6989586621679059019"><span class="annot"><span class="annottext">ltell :: CharRange -&gt; ExceptT String (Writer CharRange) ()
</span><a href="#local-6989586621679059019"><span class="hs-identifier hs-var hs-var">ltell</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT CharRange Identity ()
-&gt; ExceptT String (Writer CharRange) ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(WriterT CharRange Identity ()
 -&gt; ExceptT String (Writer CharRange) ())
-&gt; (CharRange -&gt; WriterT CharRange Identity ())
-&gt; CharRange
-&gt; ExceptT String (Writer CharRange) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; WriterT CharRange Identity ()
forall (m :: * -&gt; *) w. Monad m =&gt; w -&gt; WriterT w m ()
</span><span class="hs-identifier hs-var">tell</span></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-comment">------------------------------------------</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- OPTIMIZATION</span><span>
</span><span id="line-527"></span><span class="hs-comment">------------------------------------------</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-type">optimize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-531"></span><span id="optimize"><span class="annot"><span class="annottext">optimize :: Pattern -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#optimize"><span class="hs-identifier hs-var hs-var">optimize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621679059046"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-532"></span><span>   </span><span class="annot"><span class="annottext">[Token] -&gt; Pattern
</span><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern) -&gt; ([Token] -&gt; [Token]) -&gt; [Token] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Pattern) -&gt; [Token] -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>         </span><span id="local-6989586621679059048"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059048"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059049"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059049"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059048"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059048"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-535"></span><span>            </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall {t :: * -&gt; *}.
Foldable t =&gt;
(t Token -&gt; [Token]) -&gt; t Token -&gt; [Token]
</span><a href="#local-6989586621679059051"><span class="hs-identifier hs-var">checkUnmatchable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059049"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>         </span><span class="annot"><span class="annottext">[Token]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-537"></span><span>            </span><span class="hs-comment">-- Handle the case where the whole pattern starts with a</span><span>
</span><span id="line-538"></span><span>            </span><span class="hs-comment">-- now-literalized [.]. LongLiterals haven't been created yet so</span><span>
</span><span id="line-539"></span><span>            </span><span class="hs-comment">-- checking for Literal suffices.</span><span>
</span><span id="line-540"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-541"></span><span>                 </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>                 </span><span id="local-6989586621679059053"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059053"><span class="hs-identifier hs-var">opat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall {t :: * -&gt; *}.
Foldable t =&gt;
(t Token -&gt; [Token]) -&gt; t Token -&gt; [Token]
</span><a href="#local-6989586621679059051"><span class="hs-identifier hs-var">checkUnmatchable</span></a></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059053"><span class="hs-identifier hs-var">opat</span></a></span><span>
</span><span id="line-543"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>   </span><span id="local-6989586621679059047"><span class="annot"><span class="annottext">fin :: [Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var hs-var">fin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span>   </span><span class="hs-comment">-- Literals to LongLiteral</span><span>
</span><span id="line-547"></span><span>   </span><span class="hs-comment">-- Has to be done here: we can't backtrack in go, but some cases might</span><span>
</span><span id="line-548"></span><span>   </span><span class="hs-comment">-- result in consecutive Literals being generated.</span><span>
</span><span id="line-549"></span><span>   </span><span class="hs-comment">-- E.g. &quot;a[b]&quot;.</span><span>
</span><span id="line-550"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059067"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059067"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059068"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059068"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059069"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059069"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059070"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059070"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Char
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">isCharLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059067"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059072"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059072"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Char
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">isCharLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059068"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059073"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059073"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059074"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059074"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Maybe Char) -&gt; [Token] -&gt; (String, [Token])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="System.FilePath.Glob.Base.html#spanMaybe"><span class="hs-identifier hs-var">spanMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Maybe Char
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">isCharLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059069"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-552"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059073"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; String -&gt; String) -&gt; String -&gt; String -&gt; String
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059077"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059077"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059077"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059070"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059072"><span class="hs-identifier hs-var">y'</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059073"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>                </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059074"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span>   </span><span class="hs-comment">-- concatenate LongLiterals</span><span>
</span><span id="line-557"></span><span>   </span><span class="hs-comment">-- Has to be done here because LongLiterals are generated above.</span><span>
</span><span id="line-558"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-559"></span><span>   </span><span class="hs-comment">-- So one could say that we have one pass (go) which flattens everything as</span><span>
</span><span id="line-560"></span><span>   </span><span class="hs-comment">-- much as it can and one pass (fin) which concatenates what it can.</span><span>
</span><span id="line-561"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span id="local-6989586621679059078"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059078"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679059079"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059079"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span id="local-6989586621679059080"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059080"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679059081"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059081"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059082"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059082"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-562"></span><span>      </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059078"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059080"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059079"><span class="hs-identifier hs-var">s1</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059081"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059082"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span id="local-6989586621679059083"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059083"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679059084"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059084"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span id="local-6989586621679059085"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059085"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059086"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059086"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059083"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059084"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059085"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059086"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679059087"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059087"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059088"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059088"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059087"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059088"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span id="local-6989586621679059090"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059090"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span id="local-6989586621679059091"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059091"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679059092"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059092"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059093"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059093"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-570"></span><span>      </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; [Token]) -&gt; [Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-var">LongLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059091"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059090"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679059092"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059093"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>   </span><span class="annot"><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059094"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059094"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059095"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059095"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059094"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059095"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>   </span><span id="local-6989586621679059052"><span class="annot"><span class="annottext">go :: [Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>   </span><span class="hs-comment">-- Get rid of ExtSeparators, so that they can hopefully be combined into</span><span>
</span><span id="line-577"></span><span>   </span><span class="hs-comment">-- LongLiterals later.</span><span>
</span><span id="line-578"></span><span>   </span><span class="hs-comment">--</span><span>
</span><span id="line-579"></span><span>   </span><span class="hs-comment">-- /.                      -&gt; fine</span><span>
</span><span id="line-580"></span><span>   </span><span class="hs-comment">-- . elsewhere             -&gt; fine</span><span>
</span><span id="line-581"></span><span>   </span><span class="hs-comment">-- /[.]                    -&gt; Unmatchable</span><span>
</span><span id="line-582"></span><span>   </span><span class="hs-comment">-- [.] at start of pattern -&gt; handled outside 'go'</span><span>
</span><span id="line-583"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059101"><span class="annot"><span class="annottext">p :: Token
</span><a href="#local-6989586621679059101"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059102"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059102"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059101"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059102"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-584"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#ExtSeparator"><span class="hs-identifier hs-var">ExtSeparator</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059103"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059103"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059103"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-585"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059104"><span class="annot"><span class="annottext">p :: Token
</span><a href="#local-6989586621679059104"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059105"><span class="annot"><span class="annottext">x :: Token
</span><a href="#local-6989586621679059105"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059106"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059104"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Token -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#optimizeCharRange"><span class="hs-identifier hs-var">optimizeCharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059105"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-587"></span><span>             </span><span id="local-6989586621679059108"><span class="annot"><span class="annottext">x' :: Token
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-588"></span><span>             </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-589"></span><span>             </span><span id="local-6989586621679059109"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">x'</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059110"><span class="annot"><span class="annottext">x :: Token
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059111"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059111"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Token -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#optimizeCharRange"><span class="hs-identifier hs-var">optimizeCharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-593"></span><span>           </span><span id="local-6989586621679059112"><span class="annot"><span class="annottext">x' :: Token
</span><a href="#local-6989586621679059112"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059112"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059111"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-594"></span><span>           </span><span id="local-6989586621679059113"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059113"><span class="hs-identifier hs-var">x'</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059113"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059111"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>   </span><span class="hs-comment">-- Put [0-9] in front of &lt;-&gt; to allow compressing &lt;-&gt;[0-9]&lt;-&gt;. Handling the</span><span>
</span><span id="line-597"></span><span>   </span><span class="hs-comment">-- [0-9] first in matching should also be faster in general.</span><span>
</span><span id="line-598"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059114"><span class="annot"><span class="annottext">o :: Token
</span><a href="#local-6989586621679059114"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-type">OpenRange</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059115"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059115"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059116"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059116"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059115"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059117"><span class="hs-identifier hs-var">anyDigit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-599"></span><span>      </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059115"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059114"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059116"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>   </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059118"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679059119"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059119"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Token, Int -&gt; [Token]) -&gt; Bool)
-&gt; [(Token, Int -&gt; [Token])] -&gt; Maybe (Token, Int -&gt; [Token])
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Bool)
-&gt; ((Token, Int -&gt; [Token]) -&gt; Token)
-&gt; (Token, Int -&gt; [Token])
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Token, Int -&gt; [Token]) -&gt; Token
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Token, Int -&gt; [Token])]
</span><a href="#local-6989586621679059121"><span class="hs-identifier hs-var">compressables</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-603"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059122"><span class="annot"><span class="annottext">Int -&gt; [Token]
</span><a href="#local-6989586621679059122"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059124"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">compressed</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059125"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059125"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Bool) -&gt; [Token] -&gt; ([Token], [Token])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059119"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-604"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">compressed</span></a></span><span>
</span><span id="line-605"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059125"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-606"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Token]
</span><a href="#local-6989586621679059122"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Token] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">compressed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token] -&gt; [Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059125"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>           </span><span class="annot"><span class="annottext">Maybe (Token, Int -&gt; [Token])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; [Token]
</span><a href="#local-6989586621679059052"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679059119"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>   </span><span id="local-6989586621679059051"><span class="annot"><span class="annottext">checkUnmatchable :: (t Token -&gt; [Token]) -&gt; t Token -&gt; [Token]
</span><a href="#local-6989586621679059051"><span class="hs-identifier hs-var hs-var">checkUnmatchable</span></a></span></span><span> </span><span id="local-6989586621679059129"><span class="annot"><span class="annottext">t Token -&gt; [Token]
</span><a href="#local-6989586621679059129"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679059130"><span class="annot"><span class="annottext">t Token
</span><a href="#local-6989586621679059130"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span> </span><span class="annot"><span class="annottext">Token -&gt; t Token -&gt; Bool
forall a. Eq a =&gt; a -&gt; t a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">t Token
</span><a href="#local-6989586621679059130"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">t Token -&gt; [Token]
</span><a href="#local-6989586621679059129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t Token
</span><a href="#local-6989586621679059130"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>   </span><span id="local-6989586621679059121"><span class="annot"><span class="annottext">compressables :: [(Token, Int -&gt; [Token])]
</span><a href="#local-6989586621679059121"><span class="hs-identifier hs-var hs-var">compressables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyNonPathSeparator"><span class="hs-identifier hs-var">AnyNonPathSeparator</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Int -&gt; [Token]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#AnyDirectory"><span class="hs-identifier hs-var">AnyDirectory</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Token] -&gt; Int -&gt; [Token]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#OpenRange"><span class="hs-identifier hs-var">OpenRange</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059132"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Token -&gt; [Token]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059132"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679059117"><span class="hs-identifier hs-var">anyDigit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>   </span><span id="local-6989586621679059071"><span class="annot"><span class="annottext">isCharLiteral :: Token -&gt; Maybe Char
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var hs-var">isCharLiteral</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span id="local-6989586621679059134"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059134"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059134"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-617"></span><span>   </span><span class="annot"><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">isCharLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Char
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>   </span><span id="local-6989586621679059117"><span class="annot"><span class="annottext">anyDigit :: Token
</span><a href="#local-6989586621679059117"><span class="hs-identifier hs-var hs-var">anyDigit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Char, Char) -&gt; Either Char (Char, Char)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- | Like 'span', but let's use a -&gt; Maybe b predicate</span><span>
</span><span id="line-622"></span><span id="local-6989586621679058552"><span id="local-6989586621679058553"><span class="annot"><a href="System.FilePath.Glob.Base.html#spanMaybe"><span class="hs-identifier hs-type">spanMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679058553"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058552"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058553"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058552"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-623"></span><span id="spanMaybe"><span class="annot"><span class="annottext">spanMaybe :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([b], [a])
</span><a href="System.FilePath.Glob.Base.html#spanMaybe"><span class="hs-identifier hs-var hs-var">spanMaybe</span></a></span></span><span> </span><span id="local-6989586621679059135"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679059135"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([b], [a])
</span><a href="#local-6989586621679059136"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-624"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-625"></span><span>   </span><span id="local-6989586621679059136"><span class="annot"><span class="annottext">go :: [a] -&gt; ([b], [a])
</span><a href="#local-6989586621679059136"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679059137"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679059137"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059137"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>   </span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679059138"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679059138"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679059139"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059139"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059140"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059140"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679059135"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059139"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-627"></span><span>      </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059138"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059141"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059141"><span class="hs-identifier hs-var">y</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059142"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679059142"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059143"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059143"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([b], [a])
</span><a href="#local-6989586621679059136"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059140"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679059141"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679059142"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059143"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#optimizeCharRange"><span class="hs-identifier hs-type">optimizeCharRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-631"></span><span id="optimizeCharRange"><span class="annot"><span class="annottext">optimizeCharRange :: Bool -&gt; Token -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#optimizeCharRange"><span class="hs-identifier hs-var hs-var">optimizeCharRange</span></a></span></span><span> </span><span id="local-6989586621679059144"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059144"><span class="hs-identifier hs-var">precededBySlash</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-type">CharRange</span></a></span><span> </span><span id="local-6989586621679059145"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059145"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679059146"><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059146"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>   </span><span class="annot"><span class="annottext">CharRange -&gt; Token
</span><a href="#local-6989586621679059147"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">(CharRange -&gt; Token)
-&gt; (CharRange -&gt; CharRange) -&gt; CharRange -&gt; Token
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; CharRange
forall {b}. Eq b =&gt; [Either Char b] -&gt; [Either Char b]
</span><a href="#local-6989586621679059148"><span class="hs-identifier hs-var">stripUnmatchable</span></a></span><span> </span><span class="annot"><span class="annottext">(CharRange -&gt; CharRange)
-&gt; (CharRange -&gt; CharRange) -&gt; CharRange -&gt; CharRange
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; CharRange
forall {a}.
(Ord a, Enum a) =&gt;
[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(CharRange -&gt; CharRange)
-&gt; (CharRange -&gt; CharRange) -&gt; CharRange -&gt; CharRange
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CharRange -&gt; CharRange
</span><a href="System.FilePath.Glob.Base.html#sortCharRange"><span class="hs-identifier hs-var">sortCharRange</span></a></span><span> </span><span class="annot"><span class="annottext">(CharRange -&gt; Token) -&gt; CharRange -&gt; Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059146"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-633"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-634"></span><span>   </span><span class="hs-comment">-- [/] is interesting, it actually matches nothing at all</span><span>
</span><span id="line-635"></span><span>   </span><span class="hs-comment">-- [.] can be Literalized though, just don't make it into an ExtSeparator so</span><span>
</span><span id="line-636"></span><span>   </span><span class="hs-comment">--     that it doesn't match a leading dot</span><span>
</span><span id="line-637"></span><span>   </span><span id="local-6989586621679059147"><span class="annot"><span class="annottext">fin :: CharRange -&gt; Token
</span><a href="#local-6989586621679059147"><span class="hs-identifier hs-var hs-var">fin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679059157"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059157"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059145"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059157"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#Unmatchable"><span class="hs-identifier hs-var">Unmatchable</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679059157"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-638"></span><span>   </span><span class="annot"><a href="#local-6989586621679059147"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679059158"><span class="annot"><span class="annottext">(Char, Char)
</span><a href="#local-6989586621679059158"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059145"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Char, Char)
</span><a href="#local-6989586621679059158"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Char, Char) -&gt; (Char, Char) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#NonPathSeparator"><span class="hs-identifier hs-var">NonPathSeparator</span></a></span><span>
</span><span id="line-639"></span><span>   </span><span class="annot"><a href="#local-6989586621679059147"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span id="local-6989586621679059161"><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059161"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CharRange -&gt; Token
</span><a href="System.FilePath.Glob.Base.html#CharRange"><span class="hs-identifier hs-var">CharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059145"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">CharRange
</span><a href="#local-6989586621679059161"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>   </span><span id="local-6989586621679059148"><span class="annot"><span class="annottext">stripUnmatchable :: [Either Char b] -&gt; [Either Char b]
</span><a href="#local-6989586621679059148"><span class="hs-identifier hs-var hs-var">stripUnmatchable</span></a></span></span><span> </span><span id="local-6989586621679059167"><span class="annot"><span class="annottext">xs :: [Either Char b]
</span><a href="#local-6989586621679059167"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either Char b
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Either Char b
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Either Char b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059145"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><span class="annottext">(Either Char b -&gt; Bool) -&gt; [Either Char b] -&gt; [Either Char b]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059168"><span class="annot"><span class="annottext">Either Char b
</span><a href="#local-6989586621679059168"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059144"><span class="hs-identifier hs-var">precededBySlash</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Either Char b
</span><a href="#local-6989586621679059168"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either Char b -&gt; Either Char b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Char b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Either Char b
</span><a href="#local-6989586621679059168"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either Char b -&gt; Either Char b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Either Char b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Either Char b]
</span><a href="#local-6989586621679059167"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-643"></span><span>   </span><span class="annot"><a href="#local-6989586621679059148"><span class="hs-identifier hs-var">stripUnmatchable</span></a></span><span> </span><span id="local-6989586621679059170"><span class="annot"><span class="annottext">[Either Char b]
</span><a href="#local-6989586621679059170"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Char b]
</span><a href="#local-6989586621679059170"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>   </span><span id="local-6989586621679059149"><span class="annot"><span class="annottext">go :: [Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span>   </span><span class="annot"><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059188"><span class="annot"><span class="annottext">x :: Either a (a, a)
</span><a href="#local-6989586621679059188"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679059189"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059190"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059190"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-648"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059190"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-649"></span><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059188"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-650"></span><span>           </span><span id="local-6989586621679059191"><span class="annot"><span class="annottext">y :: Either a (a, a)
</span><a href="#local-6989586621679059191"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679059192"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059192"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059193"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059193"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-651"></span><span>              </span><span class="hs-comment">-- [aaaaa] -&gt; [a]</span><span>
</span><span id="line-652"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059192"><span class="hs-identifier hs-var">d</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span class="annot"><span class="annottext">([Either a (a, a)] -&gt; [Either a (a, a)])
-&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a (a, a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059193"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059192"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-654"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059195"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059195"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059196"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059196"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either a (a, a) -&gt; Bool)
-&gt; [Either a (a, a)] -&gt; ([Either a (a, a)], [Either a (a, a)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><a href="System.FilePath.Glob.Utils.html#isLeft"><span class="hs-identifier hs-var">isLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059190"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-comment">-- start from y</span><span>
</span><span id="line-655"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679059199"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">catable</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059200"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059200"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ([a], [a])
forall a. (Eq a, Enum a) =&gt; [a] -&gt; ([a], [a])
</span><a href="System.FilePath.Glob.Utils.html#increasingSeq"><span class="hs-identifier hs-var">increasingSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either a (a, a) -&gt; a) -&gt; [Either a (a, a)] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; a
forall a b. Either a b -&gt; a
</span><a href="System.FilePath.Glob.Utils.html#fromLeft"><span class="hs-identifier hs-var">fromLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059195"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>                     </span><span id="local-6989586621679059203"><span class="annot"><span class="annottext">range :: (a, a)
</span><a href="#local-6989586621679059203"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">catable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- three (or more) Lefts make a Right</span><span>
</span><span id="line-659"></span><span>                     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">catable</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">catable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059188"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059191"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059193"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-661"></span><span>                        </span><span class="hs-comment">-- [abcd] -&gt; [a-d]</span><span>
</span><span id="line-662"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span class="annot"><span class="annottext">([Either a (a, a)] -&gt; [Either a (a, a)])
-&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Either a (a, a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059203"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a (a, a)) -&gt; [a] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a (a, a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679059200"><span class="hs-identifier hs-var">others</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059196"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059188"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059190"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679059204"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059204"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059205"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059205"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-667"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a -&gt; Maybe (a, a)
forall a. (Ord a, Enum a) =&gt; (a, a) -&gt; a -&gt; Maybe (a, a)
</span><a href="System.FilePath.Glob.Utils.html#addToRange"><span class="hs-identifier hs-var">addToRange</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059204"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059189"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-668"></span><span>                   </span><span class="hs-comment">-- [da-c] -&gt; [a-d]</span><span>
</span><span id="line-669"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059206"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059206"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span class="annot"><span class="annottext">([Either a (a, a)] -&gt; [Either a (a, a)])
-&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Either a (a, a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059206"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059205"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-670"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (a, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059188"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059190"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span>   </span><span class="annot"><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059207"><span class="annot"><span class="annottext">x :: Either a (a, a)
</span><a href="#local-6989586621679059207"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679059208"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059208"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059209"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059209"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-673"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059209"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-674"></span><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059207"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-675"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679059210"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059210"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059211"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059211"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-676"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a -&gt; Maybe (a, a)
forall a. (Ord a, Enum a) =&gt; (a, a) -&gt; a -&gt; Maybe (a, a)
</span><a href="System.FilePath.Glob.Utils.html#addToRange"><span class="hs-identifier hs-var">addToRange</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059208"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059210"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-677"></span><span>                   </span><span class="hs-comment">-- [a-cd] -&gt; [a-d]</span><span>
</span><span id="line-678"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059212"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059212"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span class="annot"><span class="annottext">([Either a (a, a)] -&gt; [Either a (a, a)])
-&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Either a (a, a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059212"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059211"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-679"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (a, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059209"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679059213"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059213"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679059214"><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059214"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-682"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; (a, a) -&gt; Maybe (a, a)
forall a. Ord a =&gt; (a, a) -&gt; (a, a) -&gt; Maybe (a, a)
</span><a href="System.FilePath.Glob.Utils.html#overlap"><span class="hs-identifier hs-var">overlap</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059208"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059213"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-683"></span><span>                   </span><span class="hs-comment">-- [a-cb-d] -&gt; [a-d]</span><span>
</span><span id="line-684"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679059215"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059215"><span class="hs-identifier hs-var">o</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span class="annot"><span class="annottext">([Either a (a, a)] -&gt; [Either a (a, a)])
-&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; Either a (a, a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679059215"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059214"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-685"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (a, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a (a, a)
</span><a href="#local-6989586621679059207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (a, a) -&gt; [Either a (a, a)] -&gt; [Either a (a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)] -&gt; [Either a (a, a)]
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a (a, a)]
</span><a href="#local-6989586621679059209"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-686"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#optimizeCharRange"><span class="hs-identifier hs-var">optimizeCharRange</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Glob.optimizeCharRange :: internal error&quot;</span></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#sortCharRange"><span class="hs-identifier hs-type">sortCharRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span id="sortCharRange"><span class="annot"><span class="annottext">sortCharRange :: CharRange -&gt; CharRange
</span><a href="System.FilePath.Glob.Base.html#sortCharRange"><span class="hs-identifier hs-var hs-var">sortCharRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either Char (Char, Char) -&gt; Either Char (Char, Char) -&gt; Ordering)
-&gt; CharRange -&gt; CharRange
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Either Char (Char, Char) -&gt; Either Char (Char, Char) -&gt; Ordering
forall {a} {b} {b}.
Ord a =&gt;
Either a (a, b) -&gt; Either a (a, b) -&gt; Ordering
</span><a href="#local-6989586621679059216"><span class="hs-identifier hs-var">cmp</span></a></span><span>
</span><span id="line-690"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-691"></span><span>   </span><span id="local-6989586621679059216"><span class="annot"><span class="annottext">cmp :: Either a (a, b) -&gt; Either a (a, b) -&gt; Ordering
</span><a href="#local-6989586621679059216"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059224"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059224"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059225"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059225"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059224"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059225"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-692"></span><span>   </span><span class="annot"><a href="#local-6989586621679059216"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059227"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059228"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059228"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059227"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059228"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-693"></span><span>   </span><span class="annot"><a href="#local-6989586621679059216"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059229"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059229"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>   </span><span id="local-6989586621679059230"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059230"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059229"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059230"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-694"></span><span>   </span><span class="annot"><a href="#local-6989586621679059216"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059231"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059231"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059232"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059232"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059231"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059232"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- |Returns `True` iff the given `Pattern` is a literal file path, i.e. it has</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- no wildcards, character ranges, etc.</span><span>
</span><span id="line-698"></span><span class="annot"><a href="System.FilePath.Glob.Base.html#isLiteral"><span class="hs-identifier hs-type">isLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.FilePath.Glob.Base.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-699"></span><span id="isLiteral"><span class="annot"><span class="annottext">isLiteral :: Pattern -&gt; Bool
</span><a href="System.FilePath.Glob.Base.html#isLiteral"><span class="hs-identifier hs-var hs-var">isLiteral</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Bool) -&gt; [Token] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Bool
</span><a href="#local-6989586621679059234"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">([Token] -&gt; Bool) -&gt; (Pattern -&gt; [Token]) -&gt; Pattern -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; [Token]
</span><a href="System.FilePath.Glob.Base.html#unPattern"><span class="hs-identifier hs-var">unPattern</span></a></span><span>
</span><span id="line-700"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-701"></span><span>   </span><span id="local-6989586621679059234"><span class="annot"><span class="annottext">lit :: Token -&gt; Bool
</span><a href="#local-6989586621679059234"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-702"></span><span>   </span><span class="annot"><a href="#local-6989586621679059234"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.FilePath.Glob.Base.html#LongLiteral"><span class="hs-identifier hs-type">LongLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-703"></span><span>   </span><span class="annot"><a href="#local-6989586621679059234"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="System.FilePath.Glob.Base.html#PathSeparator"><span class="hs-identifier hs-var">PathSeparator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-704"></span><span>   </span><span class="annot"><a href="#local-6989586621679059234"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-705"></span></pre></body></html>